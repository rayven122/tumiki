<!doctype html>
<html lang="ja">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>MCP ProxyServer ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰</title>
    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      body {
        font-family:
          -apple-system, BlinkMacSystemFont, "Segoe UI", "Roboto",
          "Helvetica Neue", Arial, sans-serif;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: #333;
        line-height: 1.6;
        min-height: 100vh;
      }

      .container {
        max-width: 100%;
        margin: 0 auto;
        padding: 20px;
        width: 100%;
      }

      .header {
        background: rgba(255, 255, 255, 0.95);
        border-radius: 16px;
        padding: 30px;
        margin-bottom: 30px;
        backdrop-filter: blur(10px);
        box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
      }

      .header h1 {
        color: #2d3748;
        font-size: 2.5rem;
        font-weight: 700;
        margin-bottom: 10px;
        text-align: center;
      }

      .header p {
        color: #4a5568;
        font-size: 1.1rem;
        text-align: center;
      }

      .upload-section {
        background: rgba(255, 255, 255, 0.95);
        border-radius: 16px;
        padding: 30px;
        margin-bottom: 30px;
        backdrop-filter: blur(10px);
        box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
        text-align: center;
      }

      .file-input-wrapper {
        position: relative;
        display: inline-block;
        margin: 20px;
      }

      .file-input {
        position: absolute;
        opacity: 0;
        width: 0;
        height: 0;
      }

      .file-input-label {
        display: inline-block;
        padding: 15px 30px;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
        border-radius: 10px;
        cursor: pointer;
        transition: all 0.3s ease;
        font-weight: 600;
        box-shadow: 0 4px 15px rgba(102, 126, 234, 0.3);
      }

      .file-input-label:hover {
        transform: translateY(-2px);
        box-shadow: 0 6px 20px rgba(102, 126, 234, 0.4);
      }

      .loaded-files-container {
        background: #f7fafc;
        border-radius: 10px;
        padding: 20px;
        margin: 10px 0;
        max-height: 200px;
        overflow-y: auto;
      }

      .file-item {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 12px 16px;
        margin: 8px 0;
        background: white;
        border-radius: 8px;
        border-left: 4px solid #667eea;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
      }

      .file-name {
        font-weight: 600;
        color: #2d3748;
        flex-grow: 1;
      }

      .file-timestamp {
        color: #4a5568;
        font-size: 14px;
        margin-left: 10px;
      }

      .file-status {
        padding: 4px 8px;
        border-radius: 4px;
        font-size: 12px;
        font-weight: 600;
      }

      .status-loaded {
        background: #c6f6d5;
        color: #2f855a;
      }

      .controls {
        background: rgba(255, 255, 255, 0.95);
        border-radius: 16px;
        padding: 20px;
        margin-bottom: 30px;
        backdrop-filter: blur(10px);
        box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
      }

      .control-row {
        display: flex;
        flex-wrap: wrap;
        gap: 15px;
        align-items: center;
        margin-bottom: 15px;
      }

      .control-group {
        display: flex;
        align-items: center;
        gap: 10px;
      }

      .control-group label {
        font-weight: 600;
        color: #4a5568;
        min-width: 100px;
      }

      .control-group select,
      .control-group input {
        padding: 8px 12px;
        border: 1px solid #e2e8f0;
        border-radius: 6px;
        font-size: 14px;
        min-width: 150px;
      }

      .btn {
        padding: 10px 20px;
        border: none;
        border-radius: 6px;
        cursor: pointer;
        font-weight: 600;
        transition: all 0.3s ease;
      }

      .btn-primary {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
      }

      .btn-secondary {
        background: #e2e8f0;
        color: #4a5568;
      }

      .btn:hover {
        transform: translateY(-1px);
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
      }

      /* ã‚¿ãƒ–æ©Ÿèƒ½ç”¨ã‚¹ã‚¿ã‚¤ãƒ« */
      .tab-container {
        background: rgba(255, 255, 255, 0.95);
        border-radius: 16px;
        margin-bottom: 30px;
        box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
        overflow: hidden;
      }

      .nav-tabs {
        display: flex;
        list-style: none;
        margin: 0;
        padding: 0;
        background: linear-gradient(135deg, #f7fafc 0%, #edf2f7 100%);
      }

      .nav-tabs li {
        flex: 1;
      }

      .nav-tabs a {
        display: block;
        padding: 15px 20px;
        text-decoration: none;
        color: #4a5568;
        font-weight: 600;
        text-align: center;
        transition: all 0.3s ease;
        border-bottom: 3px solid transparent;
      }

      .nav-tabs a:hover {
        background: rgba(103, 126, 234, 0.1);
        color: #667eea;
      }

      .nav-tabs a.active {
        background: rgba(255, 255, 255, 0.9);
        color: #667eea;
        border-bottom-color: #667eea;
      }

      .tab-content {
        background: rgba(255, 255, 255, 0.95);
        border-radius: 16px;
        padding: 30px;
        margin-bottom: 30px;
        box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
      }

      .tab-pane {
        display: none;
      }

      .tab-pane.active {
        display: block;
      }

      .scenario-description {
        margin-bottom: 25px;
      }

      .scenario-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        cursor: pointer;
        padding: 15px 20px;
        background: linear-gradient(135deg, #e6fffa 0%, #b2f5ea 100%);
        border-radius: 12px;
        margin-bottom: 10px;
        transition: all 0.3s ease;
      }

      .scenario-header:hover {
        background: linear-gradient(135deg, #b2f5ea 0%, #81e6d9 100%);
      }

      .scenario-title {
        font-size: 1.3rem;
        font-weight: 700;
        color: #2d3748;
      }

      .toggle-icon {
        font-size: 1.2rem;
        color: #4a5568;
        transition: transform 0.3s ease;
      }

      .scenario-content {
        display: none;
        padding: 20px;
        background: rgba(255, 255, 255, 0.8);
        border-radius: 12px;
        border: 1px solid #e2e8f0;
      }

      .scenario-content.expanded {
        display: block;
      }

      .scenario-content.expanded ~ .scenario-header .toggle-icon {
        transform: rotate(180deg);
      }

      .metric-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
        gap: 15px;
        margin-bottom: 20px;
      }

      .metric-item {
        background: linear-gradient(135deg, #f7fafc 0%, #edf2f7 100%);
        padding: 15px;
        border-radius: 10px;
        border-left: 4px solid #667eea;
      }

      .metric-label {
        font-size: 0.9rem;
        color: #4a5568;
        font-weight: 600;
        margin-bottom: 5px;
      }

      .metric-value {
        font-size: 1.1rem;
        font-weight: 700;
        color: #2d3748;
      }

      .dashboard {
        display: grid !important;
        grid-template-columns: 1fr !important;
        gap: 30px;
      }

      .card {
        background: rgba(255, 255, 255, 0.95);
        border-radius: 16px;
        padding: 25px;
        backdrop-filter: blur(10px);
        box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
        width: 100%;
        max-width: none;
      }

      .card h2 {
        color: #2d3748;
        font-size: 1.5rem;
        margin-bottom: 20px;
        padding-bottom: 10px;
        border-bottom: 2px solid #e2e8f0;
      }

      .chart-container {
        width: 100%;
        height: 500px;
        margin: 20px 0;
        max-width: 100%;
        contain: layout style;
        overflow: hidden;
        isolation: isolate;
      }

      .table-container {
        overflow-x: auto;
        width: 100%;
      }

      table {
        width: 100%;
        border-collapse: collapse;
        margin-top: 15px;
        font-size: 16px;
      }

      th,
      td {
        padding: 20px 16px;
        text-align: left;
        border-bottom: 1px solid #e2e8f0;
        line-height: 1.6;
      }

      th {
        background: #f7fafc;
        font-weight: 600;
        color: #4a5568;
        position: sticky;
        top: 0;
        z-index: 10;
        font-size: 18px;
      }

      tr:hover {
        background: #f7fafc;
      }

      .metric-value {
        font-weight: 600;
        color: #2d3748;
        font-size: 18px;
      }

      .status-success {
        color: #38a169;
      }

      .status-warning {
        color: #d69e2e;
      }

      .status-error {
        color: #e53e3e;
      }

      .summary-stats {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
        gap: 20px;
        margin-bottom: 30px;
      }

      .stat-card {
        background: linear-gradient(
          135deg,
          rgba(255, 255, 255, 0.9) 0%,
          rgba(255, 255, 255, 0.7) 100%
        );
        padding: 20px;
        border-radius: 12px;
        text-align: center;
        backdrop-filter: blur(5px);
      }

      .stat-value {
        font-size: 2rem;
        font-weight: 700;
        color: #2d3748;
        margin-bottom: 5px;
      }

      .stat-label {
        color: #4a5568;
        font-size: 0.9rem;
        font-weight: 500;
      }

      .loading {
        text-align: center;
        padding: 40px;
        color: #4a5568;
      }

      .error {
        background: #fed7d7;
        color: #c53030;
        padding: 15px;
        border-radius: 8px;
        margin: 10px 0;
      }

      .warning {
        background: #fef5e7;
        color: #d69e2e;
        padding: 15px;
        border-radius: 8px;
        margin: 10px 0;
      }

      .success {
        background: #c6f6d5;
        color: #2f855a;
        padding: 15px;
        border-radius: 8px;
        margin: 10px 0;
      }

      @media (max-width: 768px) {
        .container {
          padding: 10px;
        }

        .header h1 {
          font-size: 2rem;
        }

        .control-row {
          flex-direction: column;
          align-items: stretch;
        }

        .dashboard {
          grid-template-columns: 1fr;
        }

        .card {
          padding: 15px;
        }

        .chart-container {
          height: 400px;
        }

        .criteria-table {
          font-size: 12px;
        }

        .criteria-table th,
        .criteria-table td {
          padding: 8px 6px;
        }

        .water-level-icon {
          font-size: 14px;
        }
      }
    </style>
  </head>
  <body>
    <div class="container">
      <div class="header">
        <h1>ğŸš€ MCP ProxyServer ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰</h1>
        <p>ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãƒ†ã‚¹ãƒˆãƒ¬ãƒãƒ¼ãƒˆã®çµ±åˆåˆ†æãƒ»å¯è¦–åŒ–ãƒ„ãƒ¼ãƒ«</p>

        <div
          style="
            margin-top: 20px;
            padding: 15px;
            background: rgba(102, 126, 234, 0.1);
            border-radius: 10px;
            font-size: 0.9rem;
          "
        >
          <h3 style="margin: 0 0 10px 0; color: #2d3748">ğŸ“– ä½¿ã„æ–¹ã‚¬ã‚¤ãƒ‰</h3>
          <ol style="margin: 0; padding-left: 20px; line-height: 1.8">
            <li>
              ğŸ”„
              <strong>ãƒ‡ãƒ¼ã‚¿èª­ã¿è¾¼ã¿:</strong>
              ä¸‹ã®ã€Œãƒ‡ãƒ¼ã‚¿ã‚’å†èª­ã¿è¾¼ã¿ã€ãƒœã‚¿ãƒ³ã§ãƒ†ã‚¹ãƒˆçµæœã‚’å–å¾—
            </li>
            <li>
              ğŸ“Š
              <strong>ã‚·ãƒŠãƒªã‚ªé¸æŠ:</strong>
              ã‚¿ãƒ–ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¦è¦‹ãŸã„ãƒ†ã‚¹ãƒˆã‚·ãƒŠãƒªã‚ªï¼ˆBaseline/Stressç­‰ï¼‰ã‚’é¸æŠ
            </li>
            <li>
              ğŸ“‹
              <strong>è©³ç´°ç¢ºèª:</strong>
              å„ã‚·ãƒŠãƒªã‚ªèª¬æ˜ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¦æ¸¬å®šå†…å®¹ã¨æ¨å¥¨å€¤ã‚’ç¢ºèª
            </li>
            <li>
              ğŸ“ˆ
              <strong>çµæœåˆ†æ:</strong>
              ãƒ†ãƒ¼ãƒ–ãƒ«ã§å±¥æ­´ã‚’ç¢ºèªã—ã€ãƒãƒ£ãƒ¼ãƒˆã§æ™‚ç³»åˆ—å¤‰åŒ–ã‚’æŠŠæ¡
            </li>
            <li>
              ğŸ”
              <strong>å•é¡Œè¨ºæ–­:</strong>
              æ¨å¥¨é–¾å€¤ã¨æ¯”è¼ƒã—ã¦ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹å•é¡Œã‚’ç‰¹å®š
            </li>
          </ol>
        </div>
      </div>

      <div class="upload-section">
        <h2>ğŸ“ ãƒ¬ãƒãƒ¼ãƒˆãƒ‡ãƒ¼ã‚¿èª­ã¿è¾¼ã¿çŠ¶æ…‹</h2>
        <p>
          performance_report_*.json ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ã‚µãƒ¼ãƒãƒ¼ã‹ã‚‰è‡ªå‹•èª­ã¿è¾¼ã¿ã—ã¾ã™
        </p>

        <div class="file-input-wrapper">
          <button
            class="btn btn-primary"
            onclick="manualRefresh()"
            style="margin: 10px"
          >
            ğŸ”„ ãƒ‡ãƒ¼ã‚¿ã‚’å†èª­ã¿è¾¼ã¿
          </button>
        </div>

        <div id="loadedFilesList" style="margin-top: 20px">
          <h3>ğŸ“Š èª­ã¿è¾¼ã¿æ¸ˆã¿ãƒ•ã‚¡ã‚¤ãƒ«</h3>
          <div id="fileList" class="loaded-files-container"></div>
        </div>
        <div id="serverStatus" style="margin-top: 15px"></div>
      </div>

      <!-- ã‚¿ãƒ–ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ -->
      <div class="tab-container" id="tabContainer" style="display: none">
        <ul class="nav-tabs">
          <li>
            <a href="#baseline" class="tab-link active" data-scenario="baseline"
              >ğŸ“Š Baseline</a
            >
          </li>
          <li>
            <a href="#stress" class="tab-link" data-scenario="stress"
              >âš¡ Stress</a
            >
          </li>
          <li>
            <a href="#spike" class="tab-link" data-scenario="spike">ğŸ“ˆ Spike</a>
          </li>
          <li>
            <a href="#endurance" class="tab-link" data-scenario="endurance"
              >â±ï¸ Endurance</a
            >
          </li>
          <li>
            <a href="#session" class="tab-link" data-scenario="session"
              >ğŸ”— Session</a
            >
          </li>
        </ul>
      </div>

      <!-- ã‚¿ãƒ–ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ -->
      <div class="tab-content" id="tabContent" style="display: none">
        <!-- Baseline ã‚¿ãƒ– -->
        <div id="baseline" class="tab-pane active">
          <div class="scenario-description">
            <div
              class="scenario-header"
              onclick="toggleScenarioDescription('baseline')"
            >
              <div class="scenario-title">ğŸ“Š Baseline ã‚·ãƒŠãƒªã‚ª</div>
              <div class="toggle-icon">â–¼</div>
            </div>
            <div class="scenario-content" id="baseline-description">
              <div class="metric-grid">
                <div class="metric-item">
                  <div class="metric-label">æ¸¬å®šå†…å®¹</div>
                  <div class="metric-value">æ¨™æº–è² è·ã§ã®åŸºæº–æ€§èƒ½æ¸¬å®š</div>
                </div>
                <div class="metric-item">
                  <div class="metric-label">ãƒ†ã‚¹ãƒˆè¨­å®š</div>
                  <div class="metric-value">10æ¥ç¶š Ã— 10ç§’é–“</div>
                </div>
                <div class="metric-item">
                  <div class="metric-label">æ¨å¥¨é–¾å€¤</div>
                  <div class="metric-value">ãƒ¬ã‚¹ãƒãƒ³ã‚¹æ™‚é–“ < 500ms</div>
                </div>
                <div class="metric-item">
                  <div class="metric-label">ã‚¨ãƒ©ãƒ¼ç‡ç›®å®‰</div>
                  <div class="metric-value">< 1%</div>
                </div>
              </div>
              <div style="margin-top: 15px">
                <p>
                  <strong>ğŸ“‹ ç”¨é€”:</strong>
                  ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®æ­£å¸¸æ™‚ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ã‚’æ¸¬å®šã—ã€ä»–ã®ã‚·ãƒŠãƒªã‚ªã¨ã®æ¯”è¼ƒåŸºæº–ã¨ã—ã¾ã™ã€‚
                </p>
                <p>
                  <strong>ğŸ“Š è§£é‡ˆæ–¹æ³•:</strong>
                  ã“ã®çµæœãŒè‰¯å¥½ã§ãªã„å ´åˆã€åŸºæœ¬çš„ãªè¨­å®šã‚„ã‚³ãƒ¼ãƒ‰ã«å•é¡ŒãŒã‚ã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚
                </p>
                <p>
                  <strong>ğŸ’¡ ä½¿ã„æ–¹:</strong>
                  ä¸‹ã®è¡¨ã§ãƒ†ã‚¹ãƒˆå±¥æ­´ã‚’ç¢ºèªã—ã€ãƒãƒ£ãƒ¼ãƒˆã§æ™‚ç³»åˆ—ã§ã®æ€§èƒ½å¤‰åŒ–ã‚’æŠŠæ¡ã—ã¦ãã ã•ã„ã€‚
                </p>
              </div>
            </div>
          </div>
          <div id="baseline-data-table"></div>
          <div id="baseline-comparison-charts"></div>
          <div id="baseline-chart-container"></div>
        </div>

        <!-- Stress ã‚¿ãƒ– -->
        <div id="stress" class="tab-pane">
          <div class="scenario-description">
            <div
              class="scenario-header"
              onclick="toggleScenarioDescription('stress')"
            >
              <div class="scenario-title">âš¡ Stress ã‚·ãƒŠãƒªã‚ª</div>
              <div class="toggle-icon">â–¼</div>
            </div>
            <div class="scenario-content" id="stress-description">
              <div class="metric-grid">
                <div class="metric-item">
                  <div class="metric-label">æ¸¬å®šå†…å®¹</div>
                  <div class="metric-value">é«˜è² è·æ™‚ã®æ€§èƒ½é™ç•Œãƒ†ã‚¹ãƒˆ</div>
                </div>
                <div class="metric-item">
                  <div class="metric-label">ãƒ†ã‚¹ãƒˆè¨­å®š</div>
                  <div class="metric-value">50æ¥ç¶š Ã— 30ç§’é–“</div>
                </div>
                <div class="metric-item">
                  <div class="metric-label">æ¨å¥¨é–¾å€¤</div>
                  <div class="metric-value">ãƒ¬ã‚¹ãƒãƒ³ã‚¹æ™‚é–“ < 1000ms</div>
                </div>
                <div class="metric-item">
                  <div class="metric-label">ã‚¨ãƒ©ãƒ¼ç‡ç›®å®‰</div>
                  <div class="metric-value">< 10%</div>
                </div>
              </div>
              <div style="margin-top: 15px">
                <p>
                  <strong>ğŸ“‹ ç”¨é€”:</strong>
                  é«˜è² è·çŠ¶æ…‹ã§ã®ã‚·ã‚¹ãƒ†ãƒ ã®å‹•ä½œã¨ãƒœãƒˆãƒ«ãƒãƒƒã‚¯ã®ç‰¹å®šã«ä½¿ç”¨ã—ã¾ã™ã€‚
                </p>
                <p>
                  <strong>ğŸ“Š è§£é‡ˆæ–¹æ³•:</strong>
                  ãƒ¬ã‚¹ãƒãƒ³ã‚¹æ™‚é–“ã®å¤§å¹…ãªå¢—åŠ ã‚„ã‚¨ãƒ©ãƒ¼ç‡ã®ä¸Šæ˜‡ã¯ã€ã‚¹ã‚±ãƒ¼ãƒªãƒ³ã‚°ãŒå¿…è¦ãªå…†å€™ã§ã™ã€‚
                </p>
                <p>
                  <strong>ğŸ’¡ ä½¿ã„æ–¹:</strong>
                  Baselineã‚¿ãƒ–ã®çµæœã¨æ¯”è¼ƒã—ã€é«˜è² è·æ™‚ã®æ€§èƒ½åŠ£åŒ–åº¦åˆã„ã‚’è©•ä¾¡ã—ã¦ãã ã•ã„ã€‚
                </p>
              </div>
            </div>
          </div>
          <div id="stress-data-table"></div>
          <div id="stress-comparison-charts"></div>
          <div id="stress-chart-container"></div>
        </div>

        <!-- Spike ã‚¿ãƒ– -->
        <div id="spike" class="tab-pane">
          <div class="scenario-description">
            <div
              class="scenario-header"
              onclick="toggleScenarioDescription('spike')"
            >
              <div class="scenario-title">ğŸ“ˆ Spike ã‚·ãƒŠãƒªã‚ª</div>
              <div class="toggle-icon">â–¼</div>
            </div>
            <div class="scenario-content" id="spike-description">
              <div class="metric-grid">
                <div class="metric-item">
                  <div class="metric-label">æ¸¬å®šå†…å®¹</div>
                  <div class="metric-value">çªç™ºçš„è² è·ã¸ã®å¯¾å¿œèƒ½åŠ›</div>
                </div>
                <div class="metric-item">
                  <div class="metric-label">ãƒ†ã‚¹ãƒˆè¨­å®š</div>
                  <div class="metric-value">æ€¥æ¿€ãªè² è·å¤‰å‹•ãƒ‘ã‚¿ãƒ¼ãƒ³</div>
                </div>
                <div class="metric-item">
                  <div class="metric-label">æ¨å¥¨é–¾å€¤</div>
                  <div class="metric-value">å¾©æ—§æ™‚é–“ < 3ç§’</div>
                </div>
                <div class="metric-item">
                  <div class="metric-label">ã‚¨ãƒ©ãƒ¼ç‡ç›®å®‰</div>
                  <div class="metric-value">< 30%</div>
                </div>
              </div>
              <div style="margin-top: 15px">
                <p>
                  <strong>ğŸ“‹ ç”¨é€”:</strong>
                  ãƒˆãƒ©ãƒ•ã‚£ãƒƒã‚¯ã‚¹ãƒ‘ã‚¤ã‚¯æ™‚ã®ã‚·ã‚¹ãƒ†ãƒ ã®å›å¾©åŠ›ã¨è‡ªå‹•ã‚¹ã‚±ãƒ¼ãƒªãƒ³ã‚°èƒ½åŠ›ã‚’è©•ä¾¡ã—ã¾ã™ã€‚
                </p>
                <p>
                  <strong>ğŸ“Š è§£é‡ˆæ–¹æ³•:</strong>
                  å¾©æ—§æ™‚é–“ãŒé•·ã„å ´åˆã€ã‚ªãƒ¼ãƒˆã‚¹ã‚±ãƒ¼ãƒªãƒ³ã‚°è¨­å®šã‚„ã‚­ãƒ£ãƒƒã‚·ãƒ¥æˆ¦ç•¥ã®è¦‹ç›´ã—ãŒå¿…è¦ã§ã™ã€‚
                </p>
                <p>
                  <strong>ğŸ’¡ ä½¿ã„æ–¹:</strong>
                  ãƒãƒ£ãƒ¼ãƒˆã§ã‚¹ãƒ‘ã‚¤ã‚¯ç™ºç”Ÿæ™‚ã®å›å¾©ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’ç¢ºèªã—ã€ç¬é–“çš„ãªè² è·ã«å¯¾ã™ã‚‹å¯¾å¿œåŠ›ã‚’è©•ä¾¡ã—ã¦ãã ã•ã„ã€‚
                </p>
              </div>
            </div>
          </div>
          <div id="spike-data-table"></div>
          <div id="spike-comparison-charts"></div>
          <div id="spike-chart-container"></div>
        </div>

        <!-- Endurance ã‚¿ãƒ– -->
        <div id="endurance" class="tab-pane">
          <div class="scenario-description">
            <div
              class="scenario-header"
              onclick="toggleScenarioDescription('endurance')"
            >
              <div class="scenario-title">â±ï¸ Endurance ã‚·ãƒŠãƒªã‚ª</div>
              <div class="toggle-icon">â–¼</div>
            </div>
            <div class="scenario-content" id="endurance-description">
              <div class="metric-grid">
                <div class="metric-item">
                  <div class="metric-label">æ¸¬å®šå†…å®¹</div>
                  <div class="metric-value">é•·æ™‚é–“é‹ç”¨ã§ã®å®‰å®šæ€§ãƒ†ã‚¹ãƒˆ</div>
                </div>
                <div class="metric-item">
                  <div class="metric-label">ãƒ†ã‚¹ãƒˆè¨­å®š</div>
                  <div class="metric-value">ç¶™ç¶šè² è· Ã— 60ç§’é–“</div>
                </div>
                <div class="metric-item">
                  <div class="metric-label">æ¨å¥¨é–¾å€¤</div>
                  <div class="metric-value">æ€§èƒ½åŠ£åŒ– < 20%</div>
                </div>
                <div class="metric-item">
                  <div class="metric-label">ã‚¨ãƒ©ãƒ¼ç‡ç›®å®‰</div>
                  <div class="metric-value">< 5%</div>
                </div>
              </div>
              <div style="margin-top: 15px">
                <p>
                  <strong>ğŸ“‹ ç”¨é€”:</strong>
                  ãƒ¡ãƒ¢ãƒªãƒªãƒ¼ã‚¯ã‚„ãƒªã‚½ãƒ¼ã‚¹æ¯æ¸‡ãªã©ã®é•·æ™‚é–“é‹ç”¨ã§ã®å•é¡Œã‚’ç‰¹å®šã—ã¾ã™ã€‚
                </p>
                <p>
                  <strong>ğŸ“Š è§£é‡ˆæ–¹æ³•:</strong>
                  æ™‚é–“çµŒéã¨ã¨ã‚‚ã«æ€§èƒ½ãŒåŠ£åŒ–ã™ã‚‹å ´åˆã€ãƒ¡ãƒ¢ãƒªç®¡ç†ã‚„ã‚³ãƒã‚¯ã‚·ãƒ§ãƒ³ç®¡ç†ã«å•é¡ŒãŒã‚ã‚Šã¾ã™ã€‚
                </p>
                <p>
                  <strong>ğŸ’¡ ä½¿ã„æ–¹:</strong>
                  ãƒãƒ£ãƒ¼ãƒˆã§é•·æ™‚é–“ãƒ†ã‚¹ãƒˆã§ã®æ€§èƒ½å®‰å®šæ€§ã‚’ç¢ºèªã—ã€ç¶™ç¶šé‹ç”¨ã§ã®ä¿¡é ¼æ€§ã‚’è©•ä¾¡ã—ã¦ãã ã•ã„ã€‚
                </p>
              </div>
            </div>
          </div>
          <div id="endurance-data-table"></div>
          <div id="endurance-comparison-charts"></div>
          <div id="endurance-chart-container"></div>
        </div>

        <!-- Session ã‚¿ãƒ– -->
        <div id="session" class="tab-pane">
          <div class="scenario-description">
            <div
              class="scenario-header"
              onclick="toggleScenarioDescription('session')"
            >
              <div class="scenario-title">ğŸ”— Session ã‚·ãƒŠãƒªã‚ª</div>
              <div class="toggle-icon">â–¼</div>
            </div>
            <div class="scenario-content" id="session-description">
              <div class="metric-grid">
                <div class="metric-item">
                  <div class="metric-label">æ¸¬å®šå†…å®¹</div>
                  <div class="metric-value">ã‚»ãƒƒã‚·ãƒ§ãƒ³å†åˆ©ç”¨åŠ¹ç‡ãƒ†ã‚¹ãƒˆ</div>
                </div>
                <div class="metric-item">
                  <div class="metric-label">ãƒ†ã‚¹ãƒˆè¨­å®š</div>
                  <div class="metric-value">MCPã‚»ãƒƒã‚·ãƒ§ãƒ³æ°¸ç¶šåŒ–æ¤œè¨¼</div>
                </div>
                <div class="metric-item">
                  <div class="metric-label">æ¨å¥¨é–¾å€¤</div>
                  <div class="metric-value">ã‚»ãƒƒã‚·ãƒ§ãƒ³åŠ¹ç‡ > 85%</div>
                </div>
                <div class="metric-item">
                  <div class="metric-label">ãƒ„ãƒ¼ãƒ«æˆåŠŸç‡</div>
                  <div class="metric-value">> 90%</div>
                </div>
              </div>
              <div style="margin-top: 15px">
                <p>
                  <strong>ğŸ“‹ ç”¨é€”:</strong>
                  MCPã‚»ãƒƒã‚·ãƒ§ãƒ³ã®å†åˆ©ç”¨åŠ¹ç‡ã¨ãƒ„ãƒ¼ãƒ«å®Ÿè¡ŒæˆåŠŸç‡ã‚’è©•ä¾¡ã—ã¾ã™ã€‚
                </p>
                <p>
                  <strong>ğŸ“Š è§£é‡ˆæ–¹æ³•:</strong>
                  ã‚»ãƒƒã‚·ãƒ§ãƒ³åŠ¹ç‡ãŒä½ã„å ´åˆã€ã‚»ãƒƒã‚·ãƒ§ãƒ³ãƒ—ãƒ¼ãƒ«ã®è¨­å®šèª¿æ•´ãŒå¿…è¦ã§ã™ã€‚
                </p>
                <p>
                  <strong>ğŸ’¡ ä½¿ã„æ–¹:</strong>
                  ã‚»ãƒƒã‚·ãƒ§ãƒ³åŠ¹ç‡ã¨ãƒ„ãƒ¼ãƒ«æˆåŠŸç‡ã‚’ç¢ºèªã—ã€MCPé€šä¿¡ã®æœ€é©åŒ–çŠ¶æ³ã‚’æŠŠæ¡ã—ã¦ãã ã•ã„ã€‚
                </p>
              </div>
            </div>
          </div>
          <div id="session-data-table"></div>
          <div id="session-comparison-charts"></div>
          <div id="session-chart-container"></div>
        </div>
      </div>

      <div class="loading" id="loading" style="display: none">
        <p>ğŸ“Š ãƒ‡ãƒ¼ã‚¿ã‚’åˆ†æä¸­...</p>
      </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script>
      let allReports = [];
      let filteredReports = [];
      let charts = {}; // ãƒãƒ£ãƒ¼ãƒˆã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚’ä¿å­˜
      let isLoading = false; // ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°çŠ¶æ…‹ç®¡ç†
      let currentTab = "baseline"; // ç¾åœ¨ã®ã‚¢ã‚¯ãƒ†ã‚£ãƒ–ã‚¿ãƒ–

      // ã‚¿ãƒ–åˆ¶å¾¡æ©Ÿèƒ½
      function switchTab(scenarioName) {
        // ä»¥å‰ã®ã‚¿ãƒ–ã‚’éã‚¢ã‚¯ãƒ†ã‚£ãƒ–åŒ–
        document.querySelectorAll(".tab-link").forEach((link) => {
          link.classList.remove("active");
        });
        document.querySelectorAll(".tab-pane").forEach((pane) => {
          pane.classList.remove("active");
        });

        // æ–°ã—ã„ã‚¿ãƒ–ã‚’ã‚¢ã‚¯ãƒ†ã‚£ãƒ–åŒ–
        const newTabLink = document.querySelector(
          `[data-scenario="${scenarioName}"]`,
        );
        const newTabPane = document.getElementById(scenarioName);

        if (newTabLink && newTabPane) {
          newTabLink.classList.add("active");
          newTabPane.classList.add("active");
          currentTab = scenarioName;

          // localStorage ã«ä¿å­˜
          localStorage.setItem("activeTab", scenarioName);

          // ãã®ã‚·ãƒŠãƒªã‚ªã®ãƒ‡ãƒ¼ã‚¿ã‚’æ›´æ–°
          updateTabData(scenarioName);
        }
      }

      // ã‚·ãƒŠãƒªã‚ªèª¬æ˜ã®é–‹é–‰
      function toggleScenarioDescription(scenarioName) {
        const content = document.getElementById(`${scenarioName}-description`);
        const header = content.previousElementSibling;
        const icon = header.querySelector(".toggle-icon");

        if (content.classList.contains("expanded")) {
          content.classList.remove("expanded");
          icon.textContent = "â–¼";
        } else {
          content.classList.add("expanded");
          icon.textContent = "â–²";
        }

        // localStorage ã«çŠ¶æ…‹ã‚’ä¿å­˜
        const expandedSections = JSON.parse(
          localStorage.getItem("expandedSections") || "{}",
        );
        expandedSections[scenarioName] = content.classList.contains("expanded");
        localStorage.setItem(
          "expandedSections",
          JSON.stringify(expandedSections),
        );
      }

      // ã‚¿ãƒ–ãƒ‡ãƒ¼ã‚¿æ›´æ–°
      function updateTabData(scenarioName) {
        if (!allReports.length) return;

        // ãã®ã‚·ãƒŠãƒªã‚ªã®ãƒ¬ãƒãƒ¼ãƒˆã‚’ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°
        const scenarioReports = allReports.filter((report) => {
          if (report.data && report.filename) {
            return report.filename
              .toLowerCase()
              .includes(scenarioName.toLowerCase());
          }
          return false;
        });

        // ãƒ‡ãƒ¼ã‚¿ãƒ†ãƒ¼ãƒ–ãƒ«æ›´æ–°
        updateScenarioDataTable(scenarioName, scenarioReports);

        // æ¯”è¼ƒãƒãƒ£ãƒ¼ãƒˆæ›´æ–°
        updateScenarioComparisonCharts(scenarioName, scenarioReports);

        // ãƒãƒ£ãƒ¼ãƒˆæ›´æ–°
        updateScenarioChart(scenarioName, scenarioReports);
      }

      // ã‚·ãƒŠãƒªã‚ªåˆ¥ãƒ‡ãƒ¼ã‚¿ãƒ†ãƒ¼ãƒ–ãƒ«ä½œæˆ
      function updateScenarioDataTable(scenarioName, reports) {
        const tableContainer = document.getElementById(
          `${scenarioName}-data-table`,
        );
        if (!tableContainer) return;

        if (reports.length === 0) {
          tableContainer.innerHTML =
            '<div class="no-data">ã“ã®ã‚·ãƒŠãƒªã‚ªã®ãƒ‡ãƒ¼ã‚¿ãŒã‚ã‚Šã¾ã›ã‚“</div>';
          return;
        }

        let tableHTML = `
          <h3>ğŸ“‹ ${scenarioName.charAt(0).toUpperCase() + scenarioName.slice(1)} ãƒ†ã‚¹ãƒˆçµæœä¸€è¦§</h3>
          <div style="margin-bottom: 10px; font-size: 0.9rem; color: #4a5568;">
            ğŸ’¡ <strong>è¡¨ã®è¦‹æ–¹:</strong> å®Ÿè¡Œæ—¥æ™‚é †ã«ãƒ†ã‚¹ãƒˆçµæœãŒè¡¨ç¤ºã•ã‚Œã¾ã™ã€‚ãƒ¬ã‚¹ãƒãƒ³ã‚¹æ™‚é–“ãŒçŸ­ãã€ã‚¨ãƒ©ãƒ¼ç‡ãŒä½ã„ã»ã©è‰¯å¥½ã§ã™ã€‚
          </div>
          <table class="report-table">
            <thead>
              <tr>
                <th>ğŸ“… å®Ÿè¡Œæ—¥æ™‚</th>
                <th>â±ï¸ ãƒ¬ã‚¹ãƒãƒ³ã‚¹æ™‚é–“ (ms)</th>
                <th>ğŸš€ RPS (ç§’é–“ãƒªã‚¯ã‚¨ã‚¹ãƒˆæ•°)</th>
                <th>âŒ ã‚¨ãƒ©ãƒ¼ç‡ (%)</th>
                <th>ğŸ”— ã‚»ãƒƒã‚·ãƒ§ãƒ³åŠ¹ç‡ (%)</th>
                <th>ğŸ“„ ãƒ†ã‚¹ãƒˆãƒ•ã‚¡ã‚¤ãƒ«</th>
              </tr>
            </thead>
            <tbody>
        `;

        reports.forEach((report) => {
          const data = report.data;
          const timestamp = new Date(
            data.start || data.finish || "",
          ).toLocaleString("ja-JP");
          const avgLatency = data.latency?.average?.toFixed(2) || "N/A";
          const avgRPS = data.requests?.average?.toFixed(2) || "N/A";
          const errorRate = data.requests?.total
            ? (((data.errors || 0) / data.requests.total) * 100).toFixed(2)
            : "0.00";
          const sessionEfficiency = data.performanceMetrics?.sessionEfficiency
            ? (data.performanceMetrics.sessionEfficiency * 100).toFixed(2)
            : "N/A";

          tableHTML += `
            <tr>
              <td>${timestamp}</td>
              <td>${avgLatency} ms</td>
              <td>${avgRPS}</td>
              <td>${errorRate}%</td>
              <td>${sessionEfficiency}%</td>
              <td class="filename">${report.filename}</td>
            </tr>
          `;
        });

        tableHTML += "</tbody></table>";
        tableContainer.innerHTML = tableHTML;
      }

      // ã‚·ãƒŠãƒªã‚ªåˆ¥ãƒãƒ£ãƒ¼ãƒˆæ›´æ–°
      function updateScenarioChart(scenarioName, reports) {
        const chartContainer = document.getElementById(
          `${scenarioName}-chart-container`,
        );
        if (!chartContainer) return;

        if (reports.length === 0) {
          chartContainer.innerHTML =
            '<div class="no-data">ãƒãƒ£ãƒ¼ãƒˆãƒ‡ãƒ¼ã‚¿ãŒã‚ã‚Šã¾ã›ã‚“</div>';
          return;
        }

        // æ—¢å­˜ã®ãƒãƒ£ãƒ¼ãƒˆã‚’å‰Šé™¤
        const existingChart = charts[`${scenarioName}-chart`];
        if (existingChart) {
          existingChart.destroy();
          delete charts[`${scenarioName}-chart`];
        }

        // ãƒãƒ£ãƒ¼ãƒˆã‚³ãƒ³ãƒ†ãƒŠã‚’ä½œæˆ
        chartContainer.innerHTML = `
          <h3>ğŸ“ˆ ${scenarioName.charAt(0).toUpperCase() + scenarioName.slice(1)} ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãƒˆãƒ¬ãƒ³ãƒ‰</h3>
          <div style="margin-bottom: 15px; font-size: 0.9rem; color: #4a5568;">
            ğŸ’¡ <strong>ã‚°ãƒ©ãƒ•ã®è¦‹æ–¹:</strong> é’ç·šã¯ãƒ¬ã‚¹ãƒãƒ³ã‚¹æ™‚é–“ï¼ˆå·¦è»¸ï¼‰ã€ç·‘ç·šã¯RPSï¼ˆå³è»¸ï¼‰ã€èµ¤ç·šã¯ã‚¨ãƒ©ãƒ¼ç‡ã‚’è¡¨ã—ã¾ã™ã€‚æ™‚ç³»åˆ—ã§æ€§èƒ½å¤‰åŒ–ã‚’æŠŠæ¡ã§ãã¾ã™ã€‚
          </div>
          <div class="chart-wrapper">
            <canvas id="${scenarioName}-canvas" width="400" height="200"></canvas>
          </div>
        `;

        // ãƒ‡ãƒ¼ã‚¿ã‚’æ™‚ç³»åˆ—é †ã«ã‚½ãƒ¼ãƒˆ
        reports.sort((a, b) => {
          const timeA = new Date(a.data.start || a.data.finish || 0);
          const timeB = new Date(b.data.start || b.data.finish || 0);
          return timeA - timeB;
        });

        // ãƒãƒ£ãƒ¼ãƒˆãƒ‡ãƒ¼ã‚¿ã‚’æº–å‚™
        const labels = reports.map((report) => {
          const date = new Date(report.data.start || report.data.finish || "");
          return date.toLocaleString("ja-JP", {
            month: "2-digit",
            day: "2-digit",
            hour: "2-digit",
            minute: "2-digit",
          });
        });

        const latencyData = reports.map(
          (report) => report.data.latency?.average || 0,
        );
        const rpsData = reports.map(
          (report) => report.data.requests?.average || 0,
        );
        const errorRates = reports.map((report) => {
          const errors = report.data.errors || 0;
          const total = report.data.requests?.total;
          return total ? (errors / total) * 100 : 0;
        });

        // Chart.js ã§ãƒãƒ£ãƒ¼ãƒˆã‚’ä½œæˆ
        const ctx = document.getElementById(`${scenarioName}-canvas`);
        const chart = new Chart(ctx, {
          type: "line",
          data: {
            labels: labels,
            datasets: [
              {
                label: "ãƒ¬ã‚¹ãƒãƒ³ã‚¹æ™‚é–“ (ms)",
                data: latencyData,
                borderColor: "rgb(102, 126, 234)",
                backgroundColor: "rgba(102, 126, 234, 0.1)",
                yAxisID: "y",
              },
              {
                label: "RPS",
                data: rpsData,
                borderColor: "rgb(34, 197, 94)",
                backgroundColor: "rgba(34, 197, 94, 0.1)",
                yAxisID: "y1",
              },
              {
                label: "ã‚¨ãƒ©ãƒ¼ç‡ (%)",
                data: errorRates,
                borderColor: "rgb(239, 68, 68)",
                backgroundColor: "rgba(239, 68, 68, 0.1)",
                yAxisID: "y2",
              },
            ],
          },
          options: {
            responsive: true,
            interaction: {
              mode: "index",
              intersect: false,
            },
            scales: {
              x: {
                display: true,
                title: {
                  display: true,
                  text: "å®Ÿè¡Œæ™‚é–“",
                },
              },
              y: {
                type: "linear",
                display: true,
                position: "left",
                title: {
                  display: true,
                  text: "ãƒ¬ã‚¹ãƒãƒ³ã‚¹æ™‚é–“ (ms)",
                },
              },
              y1: {
                type: "linear",
                display: true,
                position: "right",
                title: {
                  display: true,
                  text: "RPS",
                },
                grid: {
                  drawOnChartArea: false,
                },
              },
              y2: {
                type: "linear",
                display: false,
                position: "right",
              },
            },
            plugins: {
              tooltip: {
                mode: "index",
                intersect: false,
              },
              legend: {
                display: true,
                position: "top",
              },
            },
          },
        });

        charts[`${scenarioName}-chart`] = chart;
      }

      // ã‚·ãƒŠãƒªã‚ªåˆ¥æ¯”è¼ƒãƒãƒ£ãƒ¼ãƒˆä½œæˆ
      function updateScenarioComparisonCharts(scenarioName, reports) {
        const comparisonContainer = document.getElementById(
          `${scenarioName}-comparison-charts`,
        );
        if (!comparisonContainer) return;

        if (reports.length === 0) {
          comparisonContainer.innerHTML =
            '<div class="no-data">æ¯”è¼ƒãƒ‡ãƒ¼ã‚¿ãŒã‚ã‚Šã¾ã›ã‚“</div>';
          return;
        }

        // æ—¢å­˜ã®æ¯”è¼ƒãƒãƒ£ãƒ¼ãƒˆã‚’å‰Šé™¤
        const existingRpsChart = charts[`${scenarioName}-rps-comparison`];
        const existingLatencyChart =
          charts[`${scenarioName}-latency-comparison`];
        if (existingRpsChart) {
          existingRpsChart.destroy();
          delete charts[`${scenarioName}-rps-comparison`];
        }
        if (existingLatencyChart) {
          existingLatencyChart.destroy();
          delete charts[`${scenarioName}-latency-comparison`];
        }

        // æ¯”è¼ƒãƒãƒ£ãƒ¼ãƒˆã‚³ãƒ³ãƒ†ãƒŠã‚’ä½œæˆ
        comparisonContainer.innerHTML = `
          <div class="comparison-section">
            <h3>ğŸ“Š ${scenarioName.charAt(0).toUpperCase() + scenarioName.slice(1)} RPSãƒ»ãƒ¬ã‚¤ãƒ†ãƒ³ã‚·æ¯”è¼ƒ</h3>
            <div style="margin-bottom: 15px; font-size: 0.9rem; color: #4a5568;">
              ğŸ’¡ <strong>æ¯”è¼ƒã®è¦‹æ–¹:</strong> ã“ã®ã‚·ãƒŠãƒªã‚ªå†…ã®å…¨ãƒ†ã‚¹ãƒˆçµæœã‚’RPSï¼ˆé’ï¼‰ã¨ãƒ¬ã‚¹ãƒãƒ³ã‚¹æ™‚é–“ï¼ˆèµ¤ï¼‰ã§æ¯”è¼ƒã§ãã¾ã™ã€‚é«˜ã„RPSãƒ»ä½ã„ãƒ¬ã‚¹ãƒãƒ³ã‚¹æ™‚é–“ãŒç†æƒ³çš„ã§ã™ã€‚
            </div>
            
            <div class="comparison-charts-grid" style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 30px;">
              <div class="comparison-chart-container">
                <h4 style="text-align: center; color: #2d3748; margin-bottom: 10px;">ğŸš€ RPS æ¯”è¼ƒ</h4>
                <canvas id="${scenarioName}-rps-comparison-canvas" style="max-height: 300px;"></canvas>
              </div>
              <div class="comparison-chart-container">
                <h4 style="text-align: center; color: #2d3748; margin-bottom: 10px;">â±ï¸ ãƒ¬ã‚¹ãƒãƒ³ã‚¹æ™‚é–“ æ¯”è¼ƒ</h4>
                <canvas id="${scenarioName}-latency-comparison-canvas" style="max-height: 300px;"></canvas>
              </div>
            </div>
          </div>
        `;

        // ãƒ‡ãƒ¼ã‚¿ã‚’æ™‚ç³»åˆ—é †ã«ã‚½ãƒ¼ãƒˆ
        reports.sort((a, b) => {
          const timeA = new Date(a.data.start || a.data.finish || 0);
          const timeB = new Date(b.data.start || b.data.finish || 0);
          return timeA - timeB;
        });

        // RPSæ¯”è¼ƒãƒãƒ£ãƒ¼ãƒˆä½œæˆ
        createRPSComparisonChart(scenarioName, reports);

        // ãƒ¬ã‚¤ãƒ†ãƒ³ã‚·æ¯”è¼ƒãƒãƒ£ãƒ¼ãƒˆä½œæˆ
        createLatencyComparisonChart(scenarioName, reports);
      }

      // RPSæ¯”è¼ƒãƒãƒ£ãƒ¼ãƒˆä½œæˆ
      function createRPSComparisonChart(scenarioName, reports) {
        const ctx = document.getElementById(
          `${scenarioName}-rps-comparison-canvas`,
        );
        if (!ctx) return;

        const labels = reports.map((report, index) => {
          const date = new Date(report.data.start || report.data.finish || "");
          return `ãƒ†ã‚¹ãƒˆ${index + 1}\n${date.toLocaleString("ja-JP", { month: "2-digit", day: "2-digit", hour: "2-digit", minute: "2-digit" })}`;
        });

        const rpsData = reports.map(
          (report) => report.data.requests?.average || 0,
        );

        const chart = new Chart(ctx, {
          type: "bar",
          data: {
            labels: labels,
            datasets: [
              {
                label: "RPS (ç§’é–“ãƒªã‚¯ã‚¨ã‚¹ãƒˆæ•°)",
                data: rpsData,
                backgroundColor: "rgba(59, 130, 246, 0.8)",
                borderColor: "rgba(59, 130, 246, 1)",
                borderWidth: 2,
                borderRadius: 4,
              },
            ],
          },
          options: {
            responsive: true,
            maintainAspectRatio: false,
            plugins: {
              legend: {
                display: true,
                position: "top",
              },
              tooltip: {
                callbacks: {
                  title: function (context) {
                    const reportIndex = context[0].dataIndex;
                    const report = reports[reportIndex];
                    const date = new Date(
                      report.data.start || report.data.finish || "",
                    );
                    return `ãƒ†ã‚¹ãƒˆå®Ÿè¡Œæ™‚åˆ»: ${date.toLocaleString("ja-JP")}`;
                  },
                  label: function (context) {
                    return `RPS: ${context.parsed.y.toFixed(2)}`;
                  },
                },
              },
            },
            scales: {
              x: {
                ticks: {
                  font: { size: 10 },
                },
              },
              y: {
                beginAtZero: true,
                title: {
                  display: true,
                  text: "Requests per Second",
                  font: { weight: "bold" },
                },
              },
            },
          },
        });

        charts[`${scenarioName}-rps-comparison`] = chart;
      }

      // ãƒ¬ã‚¤ãƒ†ãƒ³ã‚·æ¯”è¼ƒãƒãƒ£ãƒ¼ãƒˆä½œæˆ
      function createLatencyComparisonChart(scenarioName, reports) {
        const ctx = document.getElementById(
          `${scenarioName}-latency-comparison-canvas`,
        );
        if (!ctx) return;

        const labels = reports.map((report, index) => {
          const date = new Date(report.data.start || report.data.finish || "");
          return `ãƒ†ã‚¹ãƒˆ${index + 1}\n${date.toLocaleString("ja-JP", { month: "2-digit", day: "2-digit", hour: "2-digit", minute: "2-digit" })}`;
        });

        const avgLatencyData = reports.map(
          (report) => report.data.latency?.average || 0,
        );
        const p50LatencyData = reports.map(
          (report) => report.data.latency?.p50 || 0,
        );
        const p99LatencyData = reports.map(
          (report) => report.data.latency?.p99 || 0,
        );

        const chart = new Chart(ctx, {
          type: "bar",
          data: {
            labels: labels,
            datasets: [
              {
                label: "å¹³å‡ãƒ¬ã‚¹ãƒãƒ³ã‚¹æ™‚é–“",
                data: avgLatencyData,
                backgroundColor: "rgba(239, 68, 68, 0.6)",
                borderColor: "rgba(239, 68, 68, 1)",
                borderWidth: 2,
              },
              {
                label: "P50ãƒ¬ã‚¹ãƒãƒ³ã‚¹æ™‚é–“",
                data: p50LatencyData,
                backgroundColor: "rgba(245, 158, 11, 0.6)",
                borderColor: "rgba(245, 158, 11, 1)",
                borderWidth: 2,
              },
              {
                label: "P99ãƒ¬ã‚¹ãƒãƒ³ã‚¹æ™‚é–“",
                data: p99LatencyData,
                backgroundColor: "rgba(168, 85, 247, 0.6)",
                borderColor: "rgba(168, 85, 247, 1)",
                borderWidth: 2,
              },
            ],
          },
          options: {
            responsive: true,
            maintainAspectRatio: false,
            plugins: {
              legend: {
                display: true,
                position: "top",
              },
              tooltip: {
                callbacks: {
                  title: function (context) {
                    const reportIndex = context[0].dataIndex;
                    const report = reports[reportIndex];
                    const date = new Date(
                      report.data.start || report.data.finish || "",
                    );
                    return `ãƒ†ã‚¹ãƒˆå®Ÿè¡Œæ™‚åˆ»: ${date.toLocaleString("ja-JP")}`;
                  },
                  label: function (context) {
                    return `${context.dataset.label}: ${context.parsed.y.toFixed(2)}ms`;
                  },
                },
              },
            },
            scales: {
              x: {
                ticks: {
                  font: { size: 10 },
                },
              },
              y: {
                beginAtZero: true,
                title: {
                  display: true,
                  text: "ãƒ¬ã‚¹ãƒãƒ³ã‚¹æ™‚é–“ (ms)",
                  font: { weight: "bold" },
                },
              },
            },
          },
        });

        charts[`${scenarioName}-latency-comparison`] = chart;
      }

      // ã‚¿ãƒ–ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã‚’è¡¨ç¤º
      function showTabInterface() {
        const tabContainer = document.getElementById("tabContainer");
        const tabContent = document.getElementById("tabContent");
        const oldControls = document.getElementById("controls");

        if (tabContainer) tabContainer.style.display = "block";
        if (tabContent) tabContent.style.display = "block";
        if (oldControls) oldControls.style.display = "none";
      }

      // æ‰‹å‹•ãƒªãƒ•ãƒ¬ãƒƒã‚·ãƒ¥æ©Ÿèƒ½
      function manualRefresh() {
        loadFromServer().then(() => {
          if (currentTab) {
            updateTabData(currentTab);
          }
        });
      }

      // CSS ã‚¹ã‚¿ã‚¤ãƒ«ã‚’ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã§è¿½åŠ 
      function addMissingStyles() {
        const style = document.createElement("style");
        style.textContent = `
          .report-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 15px;
            background: white;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
          }

          .report-table th,
          .report-table td {
            padding: 12px 15px;
            text-align: left;
            border-bottom: 1px solid #e2e8f0;
          }

          .report-table th {
            background: linear-gradient(135deg, #f7fafc 0%, #edf2f7 100%);
            font-weight: 600;
            color: #2d3748;
            font-size: 0.9rem;
          }

          .report-table tbody tr:hover {
            background: rgba(102, 126, 234, 0.05);
          }

          .report-table .filename {
            font-size: 0.8rem;
            color: #4a5568;
            max-width: 200px;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
          }

          .no-data {
            text-align: center;
            padding: 40px 20px;
            color: #4a5568;
            font-style: italic;
          }

          .chart-wrapper {
            position: relative;
            contain: layout style !important;
            overflow: hidden !important;
            isolation: isolate !important;
            margin: 20px 0;
            padding: 20px;
            background: rgba(255, 255, 255, 0.8);
            border-radius: 12px;
            border: 1px solid #e2e8f0;
          }

          .success {
            color: #22543d;
            background: #c6f6d5;
            padding: 10px 15px;
            border-radius: 6px;
          }

          .warning {
            color: #744210;
            background: #fed7aa;
            padding: 10px 15px;
            border-radius: 6px;
          }

          @media (max-width: 768px) {
            .nav-tabs {
              flex-direction: column;
            }
            
            .nav-tabs a {
              text-align: center;
              font-size: 0.9rem;
              padding: 10px 15px;
            }
            
            .metric-grid {
              grid-template-columns: 1fr;
            }
            
            .report-table {
              font-size: 0.8rem;
            }
            
            .report-table th,
            .report-table td {
              padding: 8px 10px;
            }
          }
        `;
        document.head.appendChild(style);
      }

      // ãƒšãƒ¼ã‚¸èª­ã¿è¾¼ã¿æ™‚ã®åˆæœŸåŒ–
      document.addEventListener("DOMContentLoaded", () => {
        initializeApp();
      });

      // ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³åˆæœŸåŒ–
      function initializeApp() {
        // å¿…è¦ãªã‚¹ã‚¿ã‚¤ãƒ«ã‚’è¿½åŠ 
        addMissingStyles();

        // æ¯”è¼ƒãƒãƒ£ãƒ¼ãƒˆç”¨ã®è¿½åŠ ã‚¹ã‚¿ã‚¤ãƒ«
        const comparisonStyle = document.createElement("style");
        comparisonStyle.textContent = `
          .comparison-section {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 16px;
            padding: 25px;
            margin-bottom: 30px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
          }

          .comparison-charts-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 30px;
          }

          .comparison-chart-container {
            background: rgba(248, 250, 252, 0.8);
            border-radius: 12px;
            padding: 20px;
            border: 1px solid #e2e8f0;
          }

          .comparison-chart-container h4 {
            text-align: center;
            color: #2d3748;
            margin-bottom: 15px;
            font-size: 1.1rem;
            font-weight: 600;
          }

          @media (max-width: 768px) {
            .comparison-charts-grid {
              grid-template-columns: 1fr;
              gap: 15px;
            }
            
            .comparison-chart-container {
              padding: 15px;
            }
            
            .comparison-chart-container h4 {
              font-size: 1rem;
            }
          }
        `;
        document.head.appendChild(comparisonStyle);

        // ãƒ­ãƒ¼ã‚«ãƒ«ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã‹ã‚‰ã‚¿ãƒ–çŠ¶æ…‹ã‚’å¾©å…ƒ
        const savedTab = localStorage.getItem("activeTab") || "baseline";
        const expandedSections = JSON.parse(
          localStorage.getItem("expandedSections") || "{}",
        );

        // ã‚¿ãƒ–ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒŠãƒ¼ã‚’è¨­å®š
        document.querySelectorAll(".tab-link").forEach((link) => {
          link.addEventListener("click", (e) => {
            e.preventDefault();
            const scenario = link.getAttribute("data-scenario");
            if (scenario) {
              switchTab(scenario);
            }
          });
        });

        // èª¬æ˜ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã®çŠ¶æ…‹ã‚’å¾©å…ƒ
        Object.keys(expandedSections).forEach((scenarioName) => {
          if (expandedSections[scenarioName]) {
            const content = document.getElementById(
              `${scenarioName}-description`,
            );
            const header = content?.previousElementSibling;
            const icon = header?.querySelector(".toggle-icon");

            if (content) {
              content.classList.add("expanded");
              if (icon) icon.textContent = "â–²";
            }
          }
        });

        // ãƒ‡ãƒ¼ã‚¿èª­ã¿è¾¼ã¿
        loadFromServer().then(() => {
          // ä¿å­˜ã•ã‚ŒãŸã‚¿ãƒ–ã«åˆ‡ã‚Šæ›¿ãˆ
          switchTab(savedTab);
        });
      }

      /**
       * æ—¢å­˜ã®ãƒãƒ£ãƒ¼ãƒˆã‚’ç ´æ£„
       */
      function destroyChart(chartId) {
        if (charts[chartId]) {
          charts[chartId].destroy();
          delete charts[chartId];

          // è¦ªã‚³ãƒ³ãƒ†ãƒŠã®ã‚¹ã‚¿ã‚¤ãƒ«ã‚’ãƒªã‚»ãƒƒãƒˆ
          const container = document.getElementById(chartId);
          if (container) {
            container.removeAttribute("style");
            // ã‚­ãƒ£ãƒ³ãƒã‚¹è¦ç´ ã‚‚ç¢ºå®Ÿã«ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—
            const canvas = container.querySelector("canvas");
            if (canvas) {
              canvas.removeAttribute("style");
            }
          }
        }
      }

      /**
       * å…¨ã¦ã®ãƒãƒ£ãƒ¼ãƒˆã‚’ç ´æ£„
       */
      function destroyAllCharts() {
        Object.keys(charts).forEach((chartId) => {
          if (charts[chartId]) {
            charts[chartId].destroy();
            delete charts[chartId];
          }
        });
      }

      function showLoading(show) {
        document.getElementById("loading").style.display = show
          ? "block"
          : "none";
      }

      function showError(message) {
        const errorDiv = document.createElement("div");
        errorDiv.className = "error";
        errorDiv.textContent = message;
        document.querySelector(".upload-section").appendChild(errorDiv);
        setTimeout(() => errorDiv.remove(), 5000);
      }

      function showSuccess(message) {
        const successDiv = document.createElement("div");
        successDiv.className = "success";
        successDiv.textContent = message;
        document.querySelector(".upload-section").appendChild(successDiv);
        setTimeout(() => successDiv.remove(), 3000);
      }

      /**
       * ã‚µãƒ¼ãƒãƒ¼ã‹ã‚‰ãƒ¬ãƒãƒ¼ãƒˆãƒ‡ãƒ¼ã‚¿ã‚’è‡ªå‹•èª­ã¿è¾¼ã¿
       */
      async function loadFromServer() {
        if (isLoading) return;
        isLoading = true;

        const statusDiv = document.getElementById("serverStatus");
        statusDiv.innerHTML = "<p>ğŸ”„ ã‚µãƒ¼ãƒãƒ¼ã‹ã‚‰ãƒ‡ãƒ¼ã‚¿ã‚’èª­ã¿è¾¼ã¿ä¸­...</p>";

        try {
          const response = await fetch("/api/reports/data");

          if (!response.ok) {
            throw new Error(`HTTP ${response.status}: ${response.statusText}`);
          }

          const data = await response.json();

          if (!data.success) {
            throw new Error(data.error || "Unknown server error");
          }

          if (data.reports && data.reports.length > 0) {
            // ã‚µãƒ¼ãƒãƒ¼ã‹ã‚‰ã®ãƒ‡ãƒ¼ã‚¿ã‚’ allReports å½¢å¼ã«å¤‰æ›
            allReports = data.reports.map((report) => ({
              filename: report.filename,
              data: report.data,
              type: report.type || "unknown",
            }));

            // èª­ã¿è¾¼ã‚“ã ãƒ•ã‚¡ã‚¤ãƒ«ä¸€è¦§ã‚’è¡¨ç¤º
            displayLoadedFiles(allReports);

            // ã‚¿ãƒ–æ©Ÿèƒ½ç”¨ã®åˆæœŸåŒ–
            showTabInterface();

            // ç¾åœ¨ã®ã‚¿ãƒ–ã®ãƒ‡ãƒ¼ã‚¿ã‚’æ›´æ–°
            if (currentTab) {
              updateTabData(currentTab);
            }

            statusDiv.innerHTML = `<div class="success">âœ… ã‚µãƒ¼ãƒãƒ¼ã‹ã‚‰ ${data.reports.length} ä»¶ã®ãƒ¬ãƒãƒ¼ãƒˆã‚’è‡ªå‹•èª­ã¿è¾¼ã¿ã—ã¾ã—ãŸ</div>`;
            setTimeout(() => {
              statusDiv.innerHTML = "";
            }, 3000);
          } else {
            statusDiv.innerHTML =
              '<div class="error">ğŸ“ ã‚µãƒ¼ãƒãƒ¼ã«ãƒ¬ãƒãƒ¼ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã§ã—ãŸ</div>';
            setTimeout(() => {
              statusDiv.innerHTML = "";
            }, 3000);
          }
        } catch (error) {
          console.warn("ã‚µãƒ¼ãƒãƒ¼ã‹ã‚‰ã®è‡ªå‹•èª­ã¿è¾¼ã¿ã«å¤±æ•—:", error);

          // Chart.jsã‚¨ãƒ©ãƒ¼ã®å ´åˆã¯ã€ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’å¤‰æ›´
          if (error.message && error.message.includes("Canvas")) {
            statusDiv.innerHTML = `<div class="warning">âš¡ ãƒ‡ãƒ¼ã‚¿æ›´æ–°ä¸­ã§ã™ã€‚å°‘ã€…ãŠå¾…ã¡ãã ã•ã„...</div>`;
            setTimeout(() => {
              statusDiv.innerHTML = "";
            }, 3000);
          } else {
            statusDiv.innerHTML = `<div class="error">âš ï¸ ã‚µãƒ¼ãƒãƒ¼æ¥ç¶šã«å¤±æ•—ã—ã¾ã—ãŸ: ${error.message}<br>æ‰‹å‹•ã§ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã—ã¦ãã ã•ã„</div>`;
            setTimeout(() => {
              statusDiv.innerHTML = "";
            }, 5000);
          }
        } finally {
          isLoading = false;
        }
      }

      /**
       * èª­ã¿è¾¼ã‚“ã ãƒ•ã‚¡ã‚¤ãƒ«ä¸€è¦§ã‚’è¡¨ç¤º
       */
      function displayLoadedFiles(reports) {
        const container = document.getElementById("fileList");
        if (!reports || reports.length === 0) {
          container.innerHTML =
            '<p style="text-align: center; color: #718096;">ğŸ“‚ èª­ã¿è¾¼ã¿æ¸ˆã¿ãƒ•ã‚¡ã‚¤ãƒ«ãŒã‚ã‚Šã¾ã›ã‚“</p>';
          return;
        }

        container.innerHTML = reports
          .map((report) => {
            // ã‚¿ã‚¤ãƒ ã‚¹ã‚¿ãƒ³ãƒ—ã®æŠ½å‡ºã‚’å¼·åŒ–ï¼šreportInfo.timestampã€finishã€startã€ãƒ•ã‚¡ã‚¤ãƒ«åã‚’é †ç•ªã«è©¦è¡Œ
            let timestamp = "Unknown";

            if (report.data?.reportInfo?.timestamp) {
              // unifiedå½¢å¼ã®å ´åˆ
              timestamp = report.data.reportInfo.timestamp;
            } else if (report.data?.finish) {
              // enhancedå½¢å¼ã®å ´åˆï¼ˆfinishã‚’å„ªå…ˆï¼‰
              timestamp = report.data.finish;
            } else if (report.data?.start) {
              // enhancedå½¢å¼ã®å ´åˆï¼ˆstartã‚’ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯ï¼‰
              timestamp = report.data.start;
            } else {
              // ãƒ•ã‚¡ã‚¤ãƒ«åã‹ã‚‰ã‚¿ã‚¤ãƒ ã‚¹ã‚¿ãƒ³ãƒ—ã‚’æŠ½å‡ºã‚’è©¦è¡Œ
              const filenameMatch = report.filename.match(
                /(\d{4}-\d{2}-\d{2}T\d{2}-\d{2}-\d{2}\.\d{3}Z)/,
              );
              if (filenameMatch) {
                timestamp = filenameMatch[1].replace(/-/g, ":"); // ãƒ•ã‚¡ã‚¤ãƒ«åã®å½¢å¼ã‚’ä¿®æ­£
              }
            }

            const formattedTime =
              timestamp !== "Unknown"
                ? new Date(timestamp).toLocaleString("ja-JP")
                : "ä¸æ˜";

            return `
            <div class="file-item">
              <span class="file-name">ğŸ“„ ${report.filename}</span>
              <span class="file-timestamp">${formattedTime}</span>
              <span class="file-status status-loaded">èª­ã¿è¾¼ã¿æ¸ˆã¿</span>
            </div>
          `;
          })
          .join("");
      }

      /**
       * ã‚µãƒ¼ãƒãƒ¼ã‹ã‚‰ãƒ¬ãƒãƒ¼ãƒˆä¸€è¦§ã‚’å–å¾—ï¼ˆãƒ‡ãƒãƒƒã‚°ç”¨ï¼‰
       */
      async function getServerReportsList() {
        try {
          const response = await fetch("/api/reports");
          const data = await response.json();
          console.log("Server reports:", data);
          return data;
        } catch (error) {
          console.error("Failed to fetch server reports list:", error);
          return null;
        }
      }
    </script>
  </body>
</html>

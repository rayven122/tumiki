# マイグレーションドキュメント

Tumiki のデータベースマイグレーション、システム移行に関するドキュメント。

## 📋 ドキュメント一覧

- [Offline Migration Guide](./offline-migration-guide.md) - オフラインマイグレーションガイド
- [Prisma Migration Squash Guide](./prisma-migration-squash-guide.md) - Prisma マイグレーションの統合ガイド

## 🔄 マイグレーション戦略

### データベースマイグレーション
- **Prisma Migrate** - スキーマバージョン管理
- **段階的移行** - ゼロダウンタイム
- **ロールバック計画** - 失敗時の復旧

### システム移行
- **Blue-Green デプロイ** - 無停止切り替え
- **カナリアリリース** - 段階的展開
- **データ同期** - 新旧システム並行稼働

## 🛠️ マイグレーションツール

### Prisma CLI
```bash
# マイグレーション作成
pnpm db:migrate:dev

# マイグレーション適用
pnpm db:push

# マイグレーションリセット
pnpm db:reset
```

### バックアップ・リストア
- 定期バックアップ
- ポイントインタイムリカバリ
- データ検証

## ⚠️ 注意事項

### 本番環境での実施
1. **事前準備**: バックアップ、通知
2. **実施**: メンテナンスモード、マイグレーション実行
3. **検証**: データ整合性、機能テスト
4. **完了**: サービス再開、モニタリング

### リスク管理
- データロスト防止
- パフォーマンス劣化対策
- 互換性確保
- ロールバック準備

## 📝 ベストプラクティス
- 小さな変更を頻繁に
- ステージング環境でのテスト
- マイグレーションスクリプトのレビュー
- 実行ログの保存
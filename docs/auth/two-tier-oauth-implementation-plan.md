# 二層OAuth認証 実装計画

## 概要

本ドキュメントは、[二層OAuth認証アーキテクチャ](./two-tier-oauth-architecture.md)で定義された設計を実装するための詳細な計画書です。

## 実装スコープ

### 対象機能

- Tumikiクライアント認証（第1層OAuth）
- Backend MCP OAuth連携（第2層OAuth）
- トークン管理・自動リフレッシュ
- スコープベースアクセス制御
- セキュリティ機能（暗号化、監査ログ、レート制限）

### 前提条件

- Node.js >= 22.14.0
- PostgreSQL 14以上
- Redis 7以上
- Auth0アカウント（M2M設定済み）
- 既存のProxyServer基盤

---

## Phase 1: データベーススキーマ拡張（Week 1）

### タスク1.1: OAuthClientテーブル拡張

**目的**: Backend MCP用のOAuthクライアント情報を管理

**実装内容**:

```prisma
// packages/db/prisma/schema/oauth.prisma

model OAuthClient {
  id String @id @default(cuid())

  // 関連するMCPサーバー
  mcpServerId String
  mcpServer   McpServer @relation(fields: [mcpServerId], references: [id], onDelete: Cascade)

  // DCRで取得したクライアント情報
  clientId                String /// @encrypted
  clientSecret            String? /// @encrypted
  registrationAccessToken String? /// @encrypted
  registrationClientUri   String?

  // Authorization Server情報
  authorizationServerUrl String
  tokenEndpoint          String
  authorizationEndpoint  String
  registrationEndpoint   String?
  jwksUri                String?
  revocationEndpoint     String?
  introspectionEndpoint  String?

  // Protected Resource情報
  protectedResourceUrl String?
  resourceIndicator    String?

  // メタデータ
  scopes                  String[]
  grantTypes              String[]
  responseTypes           String[]
  tokenEndpointAuthMethod String   @default("client_secret_basic")

  // クライアント設定
  redirectUris    String[]
  applicationName String?
  applicationUri  String?
  logoUri         String?
  contactEmail    String?

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  oauthTokens OAuthToken[]

  @@unique([mcpServerId])
  @@index([clientId])
}
```

**作業項目**:

- [ ] Prismaスキーマファイル作成・編集
- [ ] マイグレーションファイル生成（`pnpm db:migrate:dev`）
- [ ] テスト環境でマイグレーション検証
- [ ] 本番環境マイグレーション計画書作成

**担当**: データベースチーム

**期限**: Week 1 Day 3

**依存関係**: なし

### タスク1.2: OAuthTokenテーブル拡張

**目的**: `tokenPurpose` フィールドを追加し、Tumikiトークンとバックエンドトークンを区別

**実装内容**:

```prisma
model OAuthToken {
  // ... 既存フィールド

  /// トークンの用途を明確化
  tokenPurpose String @default("backend_mcp")
  // "tumiki_client" - AIクライアントが使用するTumikiトークン
  // "backend_mcp"   - Backend MCPサーバーへのアクセストークン

  // ... 既存フィールド

  @@unique([userMcpConfigId, tokenPurpose])
  @@index([tokenPurpose])
}
```

**作業項目**:

- [ ] `tokenPurpose` カラム追加
- [ ] ユニーク制約追加（`userMcpConfigId` + `tokenPurpose`）
- [ ] インデックス追加
- [ ] 既存データのマイグレーション（全て`backend_mcp`に設定）
- [ ] マイグレーション検証

**担当**: データベースチーム

**期限**: Week 1 Day 3

**依存関係**: タスク1.1完了後

### タスク1.3: McpApiKeyテーブル拡張

**目的**: Tumikiクライアント用のスコープ情報を管理

**実装内容**:

```prisma
model McpApiKey {
  // ... 既存フィールド

  /// スコープ情報
  scopes String[] @default([]) // ["mcp:access:notion", "mcp:access:figma"]

  // ... 既存フィールド
}
```

**作業項目**:

- [ ] `scopes` カラム追加
- [ ] デフォルト値設定
- [ ] 既存データに適切なスコープを付与するマイグレーションスクリプト作成
- [ ] マイグレーション実行・検証

**担当**: データベースチーム

**期限**: Week 1 Day 5

**依存関係**: なし

### タスク1.4: マイグレーション統合テスト

**作業項目**:

- [ ] テスト環境でのマイグレーション実行
- [ ] データ整合性チェック
- [ ] ロールバックテスト
- [ ] 本番環境マイグレーション手順書作成

**担当**: データベースチーム + QAチーム

**期限**: Week 1 Day 5

**依存関係**: タスク1.1, 1.2, 1.3完了後

---

## Phase 2: OAuthTokenManager実装（Week 2-3）

### タスク2.1: OAuthTokenManagerクラス設計

**目的**: トークン管理の中核コンポーネントを実装

**実装ファイル**: `apps/proxyServer/src/lib/oauth-token-manager.ts`

**作業項目**:

- [ ] インターフェース定義
- [ ] クラス基本構造実装
- [ ] Redisクライアント統合
- [ ] 暗号化ユーティリティ統合（`@tumiki/utils/crypto`）

**担当**: バックエンドチーム

**期限**: Week 2 Day 2

**依存関係**: Phase 1完了

### タスク2.2: トークン取得機能実装

**機能**: `getValidToken(mcpServerId, userId)`

**実装内容**:

1. Redisキャッシュ確認
2. キャッシュミス時、DBからトークン取得
3. 有効期限チェック
4. 期限切れ間近の場合、自動リフレッシュ
5. 復号化してトークン返却
6. キャッシュに保存

**作業項目**:

- [ ] キャッシュキー設計（`backend_token:{userId}:{mcpServerId}`）
- [ ] DB クエリ実装
- [ ] 有効期限チェックロジック実装
- [ ] キャッシュ保存ロジック実装
- [ ] エラーハンドリング実装

**担当**: バックエンドチーム

**期限**: Week 2 Day 4

**依存関係**: タスク2.1完了

### タスク2.3: トークンリフレッシュ機能実装

**機能**: `refreshBackendToken(tokenId)`

**実装内容**:

1. DBからトークン情報取得
2. リフレッシュトークンを使用して新トークン取得
3. DBを新トークンで更新
4. `refreshCount` インクリメント
5. エラー時は `isValid = false` に設定

**作業項目**:

- [ ] OAuth 2.0トークンリフレッシュフロー実装
- [ ] HTTPクライアント実装（各MCPサーバーのtokenEndpoint）
- [ ] エラーハンドリング（ネットワークエラー、401エラー等）
- [ ] DB更新ロジック実装
- [ ] 監査ログ記録

**担当**: バックエンドチーム

**期限**: Week 2 Day 5

**依存関係**: タスク2.2完了

### タスク2.4: キャッシュ管理機能実装

**機能**:

- `cacheToken(key, token, ttl)`
- `isExpiringSoon(token, bufferSeconds)`
- `calculateTTL(expiresAt)`

**作業項目**:

- [ ] Redisキャッシュ実装（`setex` コマンド使用）
- [ ] TTL計算ロジック実装
- [ ] 有効期限判定ロジック実装（デフォルト5分バッファ）
- [ ] キャッシュ無効化機能実装

**担当**: バックエンドチーム

**期限**: Week 3 Day 1

**依存関係**: タスク2.2完了

### タスク2.5: エラー処理・カスタムエラークラス実装

**実装内容**:

- `ReAuthRequiredError` クラス
- エラーログ記録
- トークン無効化処理

**作業項目**:

- [ ] カスタムエラークラス実装
- [ ] エラーログ記録（構造化ログ）
- [ ] トークン無効化処理実装
- [ ] エラー通知機能（オプション）

**担当**: バックエンドチーム

**期限**: Week 3 Day 2

**依存関係**: タスク2.1-2.4完了

### タスク2.6: 単体テスト実装

**テストケース**:

- トークン取得（キャッシュヒット）
- トークン取得（キャッシュミス）
- トークン自動リフレッシュ
- リフレッシュ失敗時のエラーハンドリング
- 有効期限判定
- キャッシュTTL計算

**作業項目**:

- [ ] Vitestテスト環境セットアップ
- [ ] Redisモック実装
- [ ] DBモック実装
- [ ] 全テストケース実装（カバレッジ100%目標）
- [ ] テスト実行・検証

**担当**: バックエンドチーム + QAチーム

**期限**: Week 3 Day 4

**依存関係**: タスク2.1-2.5完了

---

## Phase 3: 認証ミドルウェア実装（Week 3-4）

### タスク3.1: 統合認証ミドルウェア設計

**目的**: Tumikiトークン検証とBackend MCPトークン取得を統合

**実装ファイル**: `apps/proxyServer/src/middleware/integrated-auth.ts`

**作業項目**:

- [ ] ミドルウェア基本構造設計
- [ ] リクエストコンテキスト型定義
- [ ] Auth0 JWT検証ロジック設計

**担当**: バックエンドチーム

**期限**: Week 3 Day 5

**依存関係**: Phase 2完了

### タスク3.2: Tumikiトークン検証実装

**実装内容**:

1. `Authorization: Bearer {token}` ヘッダー抽出
2. JWT署名検証（Auth0公開鍵使用）
3. 有効期限確認
4. issuer/audience検証
5. クレーム抽出（user_id, client_id, scope等）

**作業項目**:

- [ ] JWTライブラリ統合（`jsonwebtoken`）
- [ ] Auth0公開鍵取得・キャッシュ
- [ ] JWT検証ロジック実装
- [ ] エラーハンドリング（401 Unauthorized）

**担当**: バックエンドチーム

**期限**: Week 4 Day 1

**依存関係**: タスク3.1完了

### タスク3.3: スコープ検証実装

**実装内容**:

1. 必要なスコープを決定（例: `mcp:access:notion`）
2. トークンのスコープクレームを解析
3. ワイルドカード（`mcp:access:*`）対応
4. スコープ不足時は403 Forbiddenを返却

**作業項目**:

- [ ] スコープ検証ユーティリティ実装
- [ ] ワイルドカードマッチングロジック実装
- [ ] エラーレスポンス実装（403 Forbidden）

**担当**: バックエンドチーム

**期限**: Week 4 Day 2

**依存関係**: タスク3.2完了

### タスク3.4: Backend MCPトークン取得統合

**実装内容**:

1. OAuthTokenManagerの`getValidToken`呼び出し
2. 再認証エラーハンドリング
3. リクエストコンテキストにトークン保存

**作業項目**:

- [ ] OAuthTokenManager統合
- [ ] エラーハンドリング（`ReAuthRequiredError`）
- [ ] コンテキスト保存ロジック実装

**担当**: バックエンドチーム

**期限**: Week 4 Day 3

**依存関係**: タスク3.3完了

### タスク3.5: 統合テスト

**テストケース**:

- 正常系: 有効なTumikiトークンでBackend MCPトークン取得
- 異常系: 無効なトークン（401）
- 異常系: スコープ不足（403）
- 異常系: Backend MCP再認証必要（401 re_auth_required）

**作業項目**:

- [ ] テスト環境セットアップ
- [ ] モックAuth0トークン生成
- [ ] 全テストケース実装
- [ ] E2Eテスト実行

**担当**: バックエンドチーム + QAチーム

**期限**: Week 4 Day 5

**依存関係**: タスク3.1-3.4完了

---

## Phase 4: Backend OAuth連携（Week 5-6）

### タスク4.1: Dynamic Client Registration (DCR) 実装

**目的**: 各Backend MCPサーバーに動的にOAuthクライアントを登録

**実装ファイル**: `apps/proxyServer/src/lib/oauth-dcr.ts`

**作業項目**:

- [ ] RFC 7591準拠のDCR実装
- [ ] Authorization Server Metadata取得（`.well-known/oauth-authorization-server`）
- [ ] クライアント登録リクエスト実装
- [ ] レスポンス処理（client_id, client_secret保存）
- [ ] エラーハンドリング

**担当**: バックエンドチーム

**期限**: Week 5 Day 2

**依存関係**: Phase 3完了

### タスク4.2: OAuth認証フロー実装（Authorization Code Flow）

**実装内容**:

1. 認証URL生成
2. PKCE対応（code_challenge生成）
3. コールバックハンドラー実装
4. トークン交換（認可コード → アクセストークン）
5. トークン保存（暗号化）

**作業項目**:

- [ ] 認証URL生成ロジック実装
- [ ] PKCEチャレンジ生成実装
- [ ] コールバックエンドポイント実装（`GET /oauth/callback`）
- [ ] トークン交換リクエスト実装
- [ ] 暗号化してDB保存

**担当**: バックエンドチーム

**期限**: Week 5 Day 5

**依存関係**: タスク4.1完了

### タスク4.3: Manager UIでのOAuth設定画面実装

**目的**: ユーザーがMCPサーバーのOAuth認証を実行できるUI

**実装ファイル**: `apps/manager/src/app/(dashboard)/settings/mcp-servers/[serverId]/oauth.tsx`

**作業項目**:

- [ ] OAuth認証開始ボタン実装
- [ ] ポップアップウィンドウでの認証フロー
- [ ] 認証完了通知
- [ ] エラー表示
- [ ] 認証状態表示（トークン有効期限等）

**担当**: フロントエンドチーム

**期限**: Week 6 Day 2

**依存関係**: タスク4.2完了

### タスク4.4: トークン管理UI実装

**機能**:

- トークン一覧表示
- トークン手動リフレッシュ
- トークン削除（再認証）
- トークン有効期限表示

**作業項目**:

- [ ] tRPCルーター実装（`oauthToken.ts`）
- [ ] トークン一覧取得API
- [ ] トークンリフレッシュAPI
- [ ] トークン削除API
- [ ] UI実装

**担当**: フロントエンドチーム + バックエンドチーム

**期限**: Week 6 Day 4

**依存関係**: タスク4.3完了

### タスク4.5: 統合テスト

**テストケース**:

- DCR成功フロー
- OAuth認証フロー（Authorization Code + PKCE）
- トークン取得・保存
- トークン自動リフレッシュ
- エラーハンドリング

**作業項目**:

- [ ] テスト環境構築（モックOAuthサーバー）
- [ ] E2Eテスト実装
- [ ] 実際のMCPサーバー（Notion等）での検証

**担当**: QAチーム

**期限**: Week 6 Day 5

**依存関係**: タスク4.1-4.4完了

---

## Phase 5: セキュリティ強化（Week 7）

### タスク5.1: 監査ログシステム実装

**目的**: 全ての認証イベントをログに記録

**実装内容**:

- 認証成功/失敗
- トークンリフレッシュ
- トークン取り消し
- スコープ検証失敗

**作業項目**:

- [ ] AuditLogテーブル設計・作成
- [ ] ロギングミドルウェア実装
- [ ] 構造化ログフォーマット定義
- [ ] ログ保持期間設定（デフォルト90日）

**担当**: バックエンドチーム

**期限**: Week 7 Day 2

**依存関係**: Phase 4完了

### タスク5.2: レート制限実装

**実装内容**:

- `/oauth/token`: 100リクエスト/時間/クライアント
- `/mcp/*`: 1000リクエスト/時間/ユーザー
- `/oauth/register`: 10リクエスト/時間/IP

**作業項目**:

- [ ] Redisベースのレート制限実装
- [ ] ミドルウェア実装
- [ ] 429 Too Many Requestsレスポンス実装
- [ ] Retry-Afterヘッダー設定

**担当**: バックエンドチーム

**期限**: Week 7 Day 3

**依存関係**: なし

### タスク5.3: トークン取り消しエンドポイント実装

**エンドポイント**: `POST /oauth/revoke`

**実装内容**:

- Tumikiトークンの取り消し
- Backend MCPトークンの取り消し
- 監査ログ記録

**作業項目**:

- [ ] エンドポイント実装
- [ ] トークン無効化ロジック実装
- [ ] 監査ログ統合
- [ ] APIドキュメント作成

**担当**: バックエンドチーム

**期限**: Week 7 Day 4

**依存関係**: タスク5.1完了

### タスク5.4: セキュリティレビュー

**作業項目**:

- [ ] コードレビュー（セキュリティ観点）
- [ ] 暗号化実装の検証
- [ ] スコープ検証ロジックの検証
- [ ] 脆弱性スキャン実行
- [ ] ペネトレーションテスト（オプション）

**担当**: セキュリティチーム

**期限**: Week 7 Day 5

**依存関係**: タスク5.1-5.3完了

---

## Phase 6: テスト・ドキュメント（Week 8）

### タスク6.1: 単体テスト完成

**目標**: 全実装ロジックのカバレッジ100%

**作業項目**:

- [ ] 未カバーコードの特定
- [ ] 追加テストケース実装
- [ ] カバレッジレポート生成
- [ ] カバレッジ100%達成確認

**担当**: 全チーム

**期限**: Week 8 Day 2

**依存関係**: Phase 1-5完了

### タスク6.2: 統合テスト完成

**テストシナリオ**:

1. 新規ユーザーのMCPサーバー追加フロー
2. AIクライアント認証フロー
3. MCPリクエストプロキシフロー
4. トークン自動リフレッシュフロー
5. 再認証フロー

**作業項目**:

- [ ] 全シナリオのE2Eテスト実装
- [ ] CI/CD統合
- [ ] テスト環境自動セットアップスクリプト作成

**担当**: QAチーム

**期限**: Week 8 Day 3

**依存関係**: タスク6.1完了

### タスク6.3: API ドキュメント作成

**ドキュメント対象**:

- `/oauth/register` - クライアント登録
- `/oauth/token` - トークン取得
- `/oauth/revoke` - トークン取り消し
- `/mcp/{instanceId}` - MCPプロキシ

**作業項目**:

- [ ] OpenAPI仕様書作成
- [ ] リクエスト/レスポンス例作成
- [ ] エラーコード一覧作成
- [ ] Swagger UI セットアップ

**担当**: テクニカルライター

**期限**: Week 8 Day 4

**依存関係**: Phase 1-5完了

### タスク6.4: ユーザーガイド作成

**ドキュメント内容**:

- MCPサーバーのOAuth認証設定方法
- AIクライアントの認証方法
- トラブルシューティング
- FAQ

**作業項目**:

- [ ] ユーザーガイド執筆
- [ ] スクリーンショット作成
- [ ] レビュー・修正
- [ ] ドキュメントサイト公開

**担当**: テクニカルライター + プロダクトマネージャー

**期限**: Week 8 Day 5

**依存関係**: なし

---

## Phase 7: デプロイ・リリース（Week 9）

### タスク7.1: ステージング環境デプロイ

**作業項目**:

- [ ] データベースマイグレーション実行
- [ ] 環境変数設定
- [ ] Redis設定
- [ ] Auth0設定（M2M）
- [ ] アプリケーションデプロイ
- [ ] スモークテスト実行

**担当**: DevOpsチーム

**期限**: Week 9 Day 1

**依存関係**: Phase 6完了

### タスク7.2: ステージング環境検証

**検証項目**:

- 全E2Eテストの実行
- パフォーマンステスト
- セキュリティスキャン
- 負荷テスト
- ユーザー受け入れテスト（UAT）

**作業項目**:

- [ ] テスト計画書作成
- [ ] テスト実行
- [ ] 問題の特定・修正
- [ ] 再テスト

**担当**: QAチーム + プロダクトマネージャー

**期限**: Week 9 Day 3

**依存関係**: タスク7.1完了

### タスク7.3: 本番環境デプロイ準備

**作業項目**:

- [ ] デプロイ手順書作成
- [ ] ロールバック計画作成
- [ ] データベースバックアップ計画
- [ ] モニタリング設定（Prometheus, Grafana）
- [ ] アラート設定

**担当**: DevOpsチーム

**期限**: Week 9 Day 4

**依存関係**: タスク7.2完了

### タスク7.4: 本番環境デプロイ

**デプロイ手順**:

1. メンテナンスモード有効化
2. データベースバックアップ
3. データベースマイグレーション
4. アプリケーションデプロイ
5. スモークテスト
6. メンテナンスモード解除
7. モニタリング確認

**作業項目**:

- [ ] デプロイ実行
- [ ] スモークテスト実行
- [ ] モニタリング確認
- [ ] リリースノート公開

**担当**: DevOpsチーム + プロダクトマネージャー

**期限**: Week 9 Day 5

**依存関係**: タスク7.3完了

### タスク7.5: ポストリリース監視

**監視期間**: リリース後7日間

**監視項目**:

- エラーレート
- レスポンスタイム
- トークンリフレッシュ成功率
- 認証成功率
- ユーザーフィードバック

**作業項目**:

- [ ] ダッシュボード監視
- [ ] エラーログ分析
- [ ] パフォーマンス分析
- [ ] ユーザーフィードバック収集
- [ ] 問題対応

**担当**: DevOpsチーム + カスタマーサポート

**期限**: Week 10（リリース後1週間）

**依存関係**: タスク7.4完了

---

## リスク管理

### 技術リスク

| リスク | 影響度 | 発生確率 | 対策 |
|--------|--------|----------|------|
| Auth0 M2M設定の複雑さ | 高 | 中 | 事前にAuth0ドキュメント熟読、サポート連絡先確保 |
| Backend MCPサーバーのOAuth実装の差異 | 高 | 高 | 各サーバーのドキュメント精査、テスト環境で事前検証 |
| トークンリフレッシュ失敗 | 中 | 中 | リトライロジック実装、ユーザー通知機能 |
| Redis障害時のトークン取得 | 中 | 低 | フォールバック機構（直接DB取得） |
| データベースマイグレーション失敗 | 高 | 低 | ロールバック計画、十分なテスト |

### スケジュールリスク

| リスク | 影響度 | 発生確率 | 対策 |
|--------|--------|----------|------|
| 実装遅延 | 高 | 中 | バッファ期間確保（Week 10-11）、優先度付け |
| テスト不足 | 高 | 中 | CI/CD自動化、早期テスト開始 |
| 依存関係による遅延 | 中 | 中 | 並行作業可能なタスクの特定、柔軟な計画 |

### 運用リスク

| リスク | 影響度 | 発生確率 | 対策 |
|--------|--------|----------|------|
| 本番環境でのトークン漏洩 | 高 | 低 | 監査ログ、異常検知、即座の取り消し機能 |
| パフォーマンス劣化 | 中 | 中 | Redisキャッシュ、負荷テスト |
| ユーザーの再認証頻度が高い | 中 | 中 | トークン有効期限の適切な設定、UX改善 |

---

## 成功基準

### 機能要件

- [ ] Tumikiクライアント認証が正常に動作
- [ ] Backend MCP OAuth連携が正常に動作
- [ ] トークン自動リフレッシュが正常に動作
- [ ] スコープベースアクセス制御が正常に動作
- [ ] 全てのセキュリティ機能が実装済み

### 非機能要件

- [ ] 単体テストカバレッジ100%達成
- [ ] 統合テスト全パス
- [ ] E2Eテスト全パス
- [ ] API レスポンスタイム < 200ms（P95）
- [ ] トークンリフレッシュ成功率 > 99%
- [ ] 認証成功率 > 99.9%

### ドキュメント要件

- [ ] APIドキュメント完成
- [ ] ユーザーガイド完成
- [ ] アーキテクチャドキュメント更新
- [ ] トラブルシューティングガイド完成

### デプロイ要件

- [ ] ステージング環境で問題なし
- [ ] 本番環境デプロイ成功
- [ ] ロールバック計画準備完了
- [ ] モニタリング設定完了

---

## リソース計画

### 必要人員

| 役割 | 人数 | 稼働率 | 期間 |
|------|------|--------|------|
| バックエンドエンジニア | 2名 | 100% | 9週間 |
| フロントエンドエンジニア | 1名 | 50% | 3週間（Week 5-7） |
| データベースエンジニア | 1名 | 50% | 2週間（Week 1-2） |
| QAエンジニア | 1名 | 75% | 6週間（Week 3-8） |
| DevOpsエンジニア | 1名 | 50% | 2週間（Week 7-9） |
| セキュリティエンジニア | 1名 | 25% | 1週間（Week 7） |
| テクニカルライター | 1名 | 50% | 1週間（Week 8） |
| プロダクトマネージャー | 1名 | 25% | 9週間 |

### 必要インフラ

- PostgreSQL（既存）
- Redis（既存または新規）
- Auth0アカウント（M2M設定）
- ステージング環境
- モニタリングツール（Prometheus, Grafana）

---

## コミュニケーション計画

### 定例会議

- **デイリースタンドアップ**: 毎朝10:00、15分
- **週次進捗会議**: 毎週金曜15:00、1時間
- **スプリントレビュー**: 隔週金曜16:00、1時間

### 報告体制

- **日次**: Slackで進捗報告
- **週次**: プロジェクト管理ツール（Linear）で進捗更新
- **緊急**: Slackで即座に報告、必要に応じて臨時会議

### ドキュメント管理

- **アーキテクチャ**: `docs/auth/` に保存
- **API仕様**: OpenAPI仕様書、Swagger UI
- **実装メモ**: Linear Issue、PR Description

---

## 参考資料

- [二層OAuth認証アーキテクチャ設計書](./two-tier-oauth-architecture.md)
- [RFC 6749: OAuth 2.0 Authorization Framework](https://tools.ietf.org/html/rfc6749)
- [RFC 8693: OAuth 2.0 Token Exchange](https://tools.ietf.org/html/rfc8693)
- [RFC 7591: OAuth 2.0 Dynamic Client Registration](https://tools.ietf.org/html/rfc7591)
- [MCP Authorization Specification](https://modelcontextprotocol.io/specification/draft/basic/authorization)
- [Linear Issue DEV-890](https://linear.app/rayven/issue/DEV-890)
- [Linear Issue DEV-891](https://linear.app/rayven/issue/DEV-891)

---

_作成日: 2025年1月30日_
_最終更新日: 2025年1月30日_
_作成者: Tumiki開発チーム_

# OAuth関連ドキュメント インデックス

このドキュメントは、Tumiki MCP ManagerのOAuth関連ドキュメントの概要と使い分けをまとめたものです。

## ドキュメント一覧

### 1. [OAUTH_ACCESS_TOKEN_GUIDE.md](./OAUTH_ACCESS_TOKEN_GUIDE.md)
**エンドユーザー向けトークン取得ガイド**

- **対象読者**: MCPサーバーを利用するエンドユーザー、開発者
- **目的**: OAuthプロバイダーと接続してアクセストークンを取得する手順を説明
- **主な内容**:
  - UI操作によるOAuth認証手順
  - 各プロバイダー（Google、GitHub、Slack等）の接続方法
  - トークンの管理とコピー方法
  - トラブルシューティング

**このドキュメントを読むべき場合**:
- MCPサーバーでOAuth認証が必要なサービスを使いたい
- アクセストークンの取得方法を知りたい
- OAuth接続でエラーが発生した

### 2. [OAUTH_IMPLEMENTATION.md](./OAUTH_IMPLEMENTATION.md)
**開発者向け技術実装ガイド**

- **対象読者**: Tumikiの開発者、コントリビューター
- **目的**: OAuth機能の内部実装と技術的な詳細を説明
- **主な内容**:
  - システムアーキテクチャ
  - 認証フローの技術的詳細
  - データベーススキーマ
  - Auth0クライアントの設定（`auth0`と`auth0OAuth`）
  - ProxyServerの実装詳細

**このドキュメントを読むべき場合**:
- OAuth機能の実装を理解・修正したい
- 新機能を追加したい
- バグ修正やパフォーマンス改善を行いたい

### 3. [OAUTH_PROVIDER_GUIDE.md](./OAUTH_PROVIDER_GUIDE.md)
**新規OAuthプロバイダー追加ガイド**

- **対象読者**: 新しいOAuthプロバイダーを追加したい開発者
- **目的**: 新しいOAuthプロバイダー（例：Discord、Twitter等）のサポートを追加する手順を説明
- **主な内容**:
  - Auth0での新規プロバイダー設定
  - プロバイダー設定ファイルの作成
  - スコープとトークンの設定
  - UIとMCPサーバーへの統合

**このドキュメントを読むべき場合**:
- 新しいOAuthプロバイダーのサポートを追加したい
- 既存プロバイダーのスコープを変更したい
- プロバイダー固有の処理を実装したい

### 4. [OAUTH_SEPARATE_APP_GUIDE.md](./OAUTH_SEPARATE_APP_GUIDE.md)
**Auth0構成管理ガイド**

- **対象読者**: DevOpsエンジニア、システム管理者
- **目的**: OAuth認証を別のAuth0アプリケーションで管理する方法を説明
- **主な内容**:
  - メイン認証とOAuth認証の分離アーキテクチャ
  - Auth0での専用アプリケーション設定
  - 環境変数の設定
  - ミドルウェアとルーティングの設定
  - 本番環境への移行手順

**このドキュメントを読むべき場合**:
- セキュリティ強化のため認証を分離したい
- 本番環境のAuth0設定を変更したい
- OAuth専用の設定を管理したい

## ドキュメントの相互関係

```
┌─────────────────────────────────────────────────────────────┐
│                    エンドユーザー                               │
│                         ↓                                      │
│            OAUTH_ACCESS_TOKEN_GUIDE.md                        │
│                  （使い方・操作方法）                            │
└─────────────────────────────────────────────────────────────┘
                          ↓
┌─────────────────────────────────────────────────────────────┐
│                      開発者                                    │
│                         ↓                                      │
│            ┌──────────────────────┐                          │
│            │ OAUTH_IMPLEMENTATION.md │                        │
│            │   （内部実装の理解）    │                        │
│            └──────────────────────┘                          │
│                    ↓           ↓                              │
│    ┌─────────────────┐   ┌──────────────────┐               │
│    │ PROVIDER_GUIDE   │   │ SEPARATE_APP_GUIDE │             │
│    │（プロバイダー追加）│   │  （構成管理）      │             │
│    └─────────────────┘   └──────────────────┘               │
└─────────────────────────────────────────────────────────────┘
```

## 開始点の選び方

1. **MCPサーバーを使いたい** → `OAUTH_ACCESS_TOKEN_GUIDE.md`から開始
2. **OAuth機能を改善したい** → `OAUTH_IMPLEMENTATION.md`から開始
3. **新しいサービスと連携したい** → `OAUTH_PROVIDER_GUIDE.md`から開始
4. **インフラ・セキュリティを強化したい** → `OAUTH_SEPARATE_APP_GUIDE.md`から開始

## 関連リソース

### 内部リソース
- `/packages/auth/src/oauth.ts` - OAuth関連の主要実装
- `/packages/auth/src/clients.ts` - Auth0クライアント設定
- `/apps/manager/src/server/api/routers/oauth/` - tRPC APIエンドポイント

### 外部リソース
- [Auth0ドキュメント](https://auth0.com/docs)
- [OAuth 2.0仕様](https://oauth.net/2/)

## 更新履歴

- 2024-01-28: OAuth認証エンドポイントを`/oauth/auth/*`に統一（カスタムハンドラー削除）
- 初回作成: OAuth機能の実装とドキュメント整備
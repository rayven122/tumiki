---
allowed-tools: Bash(git:*), Bash(gh:*), Read, Task
description: "既存のPRを分析してレビューコメントを生成し、承認またはフィードバックを提供する自動化コマンド"
---

指定されたPR（またはカレントブランチのPR）に対してコードレビューを実行し、変更内容を分析してレビューコメントを生成します。

## 実行手順

1. **PR情報の取得**

   - PRが指定されていない場合は、現在のブランチに関連するPRを検索
   - PR番号、タイトル、説明、変更ファイル一覧を取得

2. **変更内容の詳細分析**

   - `gh pr diff`で差分を取得
   - 変更されたファイルの種類と内容を分析
   - コード品質、ベストプラクティス、潜在的な問題を確認

3. **レビュー項目のチェック**

   - **コード品質**: 命名規則、可読性、重複コード
   - **型安全性**: TypeScriptの型定義、any型の使用
   - **セキュリティ**: APIキーの露出、SQLインジェクション、XSS
   - **パフォーマンス**: 不要な再レンダリング、N+1クエリ
   - **テスト**: テストカバレッジ、エッジケース
   - **ドキュメント**: コメント、README更新
   - **依存関係**: 新しいパッケージの必要性と安全性

4. **レビューコメントの生成**

   - 問題点と改善提案を日本語で記述
   - コード例を含む具体的なフィードバック
   - 良い点も積極的に評価

5. **レビュー結果の投稿**
   - GitHub CLIを使用してレビューコメントを投稿
   - 承認（APPROVE）、変更要求（REQUEST_CHANGES）、コメント（COMMENT）を選択

## 使用例

```bash
# 現在のブランチのPRをレビュー
/pr-review

# 特定のPR番号を指定してレビュー
/pr-review 123

# ドラフトレビュー（コメントを投稿せずに確認のみ）
/pr-review --draft
```

## レビューテンプレート

```markdown
## 📋 コードレビュー結果

### ✅ 良い点

- [良い実装やプラクティスを記載]

### ⚠️ 改善提案

- [改善が必要な箇所と具体的な提案]

### 🐛 潜在的な問題

- [バグやセキュリティの懸念事項]

### 💡 追加の提案

- [パフォーマンス改善やリファクタリングの提案]

### 📝 チェックリスト

- [ ] TypeScriptの型定義は適切か
- [ ] エラーハンドリングは十分か
- [ ] テストは追加されているか
- [ ] ドキュメントは更新されているか
- [ ] セキュリティの考慮はされているか
```

## コンテキスト取得

PR情報とコードの変更内容を取得:
!`gh pr view --json number,title,body,files`
!`gh pr diff`
!`gh pr checks`

## 前提条件

- GitHub CLI (gh) がインストール・認証済みであること
- リポジトリにPRが存在すること
- レビュー権限があること

## エラーハンドリング

- PR が見つからない場合は、PR番号の指定を促す
- 権限エラーの場合は、適切なメッセージを表示
- 大きな差分の場合は、ファイルごとに分割してレビュー

name: Comment Deployment URL
description: ãƒ‡ãƒ—ãƒ­ã‚¤URLã‚’PRã¾ãŸã¯ã‚³ãƒŸãƒƒãƒˆã«ã‚³ãƒ¡ãƒ³ãƒˆã—ã¾ã™ã€‚PRã®å ´åˆã¯æ—¢å­˜ã‚³ãƒ¡ãƒ³ãƒˆã‚’æ›´æ–°

inputs:
  vercel_url:
    description: Vercel ãƒ‡ãƒ—ãƒ­ã‚¤URL
    required: true
  cloudrun_url:
    description: Cloud Run ãƒ‡ãƒ—ãƒ­ã‚¤URL
    required: true
  environment:
    description: ãƒ‡ãƒ—ãƒ­ã‚¤ç’°å¢ƒ
    required: true
  github_token:
    description: GitHubãƒˆãƒ¼ã‚¯ãƒ³
    required: true

runs:
  using: composite
  steps:
    - name: ğŸ“ Comment on PR
      if: github.event_name == 'pull_request'
      uses: actions/github-script@v7
      with:
        github-token: ${{ inputs.github_token }}
        script: |
          const script = require('${{ github.action_path }}/../../scripts/comment-deployment.cjs');
          await script({
            github,
            context,
            vercelUrl: '${{ inputs.vercel_url }}',
            cloudrunUrl: '${{ inputs.cloudrun_url }}',
            environment: '${{ inputs.environment }}',
            isPR: true
          });

    - name: ğŸ“ Comment on commit
      if: github.event_name == 'push' && github.ref == 'refs/heads/main'
      uses: actions/github-script@v7
      with:
        github-token: ${{ inputs.github_token }}
        script: |
          await github.rest.repos.createCommitComment({
            owner: context.repo.owner,
            repo: context.repo.repo,
            commit_sha: context.sha,
            body: `âœ… Deployment to ${{ inputs.environment }} completed:\nğŸ”— Vercel: ${{ inputs.vercel_url }}\nğŸ”— Cloud Run: ${{ inputs.cloudrun_url }}`
          });

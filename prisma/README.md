# DB Schema
> Generated by [`prisma-markdown`](https://github.com/samchon/prisma-markdown)

- [McpServer](#mcpserver)
- [NextAuth](#nextauth)
- [UserMcpServer](#usermcpserver)

## McpServer
```mermaid
erDiagram
"McpServer" {
  String id PK
  String name UK
  String iconPath "nullable"
  String command
  String args
  String envVars
  Boolean isPublic
  DateTime createdAt
  DateTime updatedAt
}
"Tool" {
  String id PK
  String name
  String description
  Json inputSchema
  Boolean isEnabled
  String mcpServerId FK
  DateTime createdAt
  DateTime updatedAt
}
"McpServerConfig" {
  String id PK
  String name "nullable"
  String envVars
  String mcpServerId FK
  String userId FK
  DateTime createdAt
  DateTime updatedAt
}
"ToolGroupTool" {
  String toolGroupId FK
  String toolId FK
  String mcpServerConfigId FK
  DateTime createdAt
  DateTime updatedAt
}
"ToolGroup" {
  String id PK
  String name
  String description
  Boolean isEnabled
  String order
  String userId FK
  String mcpServerInstanceId "nullable"
  DateTime createdAt
  DateTime updatedAt
}
"McpServerInstance" {
  String id PK
  String name
  String description
  String userId FK
  String order
  DateTime createdAt
  DateTime updatedAt
}
"_McpServerConfigToTool" {
  String A FK
  String B FK
}
"_McpServerInstanceToToolGroup" {
  String A FK
  String B FK
}
"Tool" }o--|| "McpServer" : mcpServer
"McpServerConfig" }o--|| "McpServer" : mcpServer
"ToolGroupTool" }o--|| "ToolGroup" : toolGroup
"ToolGroupTool" }o--|| "Tool" : tool
"ToolGroupTool" }o--|| "McpServerConfig" : mcpServerConfig
"_McpServerConfigToTool" }o--|| "McpServerConfig" : McpServerConfig
"_McpServerConfigToTool" }o--|| "Tool" : Tool
"_McpServerInstanceToToolGroup" }o--|| "McpServerInstance" : McpServerInstance
"_McpServerInstanceToToolGroup" }o--|| "ToolGroup" : ToolGroup
```

### `McpServer`
MCP サーバー (github や notion などの接続する外部 MCP サーバー)

**Properties**
  - `id`: 
  - `name`: MCP サーバー名
  - `iconPath`: アイコンパス
  - `command`: コマンド
  - `args`: 引数
  - `envVars`: 環境変数
  - `isPublic`: サーバーが公開されているか
  - `createdAt`: 
  - `updatedAt`: 

### `Tool`
MCP サーバーのツール一覧

**Properties**
  - `id`: 
  - `name`: ツールの名前
  - `description`: ツールの説明
  - `inputSchema`: ツールの入力スキーマ（JSON Schema形式）
  - `isEnabled`: ツールを有効にするか
  - `mcpServerId`: 
  - `createdAt`: 
  - `updatedAt`: 

### `McpServerConfig`
ユーザーが利用できるMCPサーバーの設定

**Properties**
  - `id`: 
  - `name`: カスタムMCPサーバー名 (ユーザーが設定した名前)
  - `envVars`: MCPサーバーの envVars を文字配列を key にしたオブジェクトを Object.stringify + 暗号化したもの
  - `mcpServerId`: MCPサーバーID
  - `userId`: ユーザーID
  - `createdAt`: 
  - `updatedAt`: 

### `ToolGroupTool`
ToolGroup, Tool, McpServerConfig の関連を表す中間テーブル

**Properties**
  - `toolGroupId`: ToolGroupへの参照
  - `toolId`: Toolへの参照
  - `mcpServerConfigId`: このToolがどのUserMcpServerに属しているか
  - `createdAt`: 
  - `updatedAt`: 

### `ToolGroup`
どのツール群を利用するかを設定する

**Properties**
  - `id`: 
  - `name`: ツールグループ名
  - `description`: ツールグループの説明
  - `isEnabled`: ツールグループが有効かどうか
  - `order`: ツールの表示順序を保持するためのID配列
  - `userId`: ユーザーID
  - `mcpServerInstanceId`: McpServerInstance に直接紐づくものは、id を管理する
  - `createdAt`: 
  - `updatedAt`: 

### `McpServerInstance`
MCPサーバーとして利用するインスタンス

**Properties**
  - `id`: 
  - `name`: サーバー名
  - `description`: サーバーの説明
  - `userId`: ユーザーID
  - `order`: ツールグループとツールの表示順序を保持するためのID配列
  - `createdAt`: 
  - `updatedAt`: 

### `_McpServerConfigToTool`
Pair relationship table between [McpServerConfig](#McpServerConfig) and [Tool](#Tool)

**Properties**
  - `A`: 
  - `B`: 

### `_McpServerInstanceToToolGroup`
Pair relationship table between [McpServerInstance](#McpServerInstance) and [ToolGroup](#ToolGroup)

**Properties**
  - `A`: 
  - `B`: 


## NextAuth
```mermaid
erDiagram
"Account" {
  String id PK
  String userId FK
  String type
  String provider
  String providerAccountId
  String refresh_token "nullable"
  String access_token "nullable"
  Int expires_at "nullable"
  String token_type "nullable"
  String scope "nullable"
  String id_token "nullable"
  String session_state "nullable"
  Int refresh_token_expires_in "nullable"
}
"Session" {
  String id PK
  String sessionToken UK
  String userId FK
  DateTime expires
}
"User" {
  String id PK
  String name "nullable"
  String email UK "nullable"
  DateTime emailVerified "nullable"
  String image "nullable"
  Role role
  MembershipType membership
}
"VerificationToken" {
  String identifier
  String token UK
  DateTime expires
}
"Account" }o--|| "User" : user
"Session" }o--|| "User" : user
```

### `Account`

**Properties**
  - `id`: 
  - `userId`: 
  - `type`: 認証プロバイダーの種類（oauth, oidc, email, credentials）
  - `provider`: 認証プロバイダー名（google, github, etc.）
  - `providerAccountId`: プロバイダー側のアカウントID
  - `refresh_token`: リフレッシュトークン
  - `access_token`: アクセストークン
  - `expires_at`: トークンの有効期限（Unixタイムスタンプ）
  - `token_type`: トークンの種類
  - `scope`: 認可スコープ
  - `id_token`: IDトークン
  - `session_state`: セッション状態
  - `refresh_token_expires_in`: リフレッシュトークンの有効期限（秒）

### `Session`

**Properties**
  - `id`: 
  - `sessionToken`: セッショントークン
  - `userId`: 
  - `expires`: セッションの有効期限

### `User`

**Properties**
  - `id`: 
  - `name`: ユーザー名
  - `email`: メールアドレス
  - `emailVerified`: メールアドレスの検証日時
  - `image`: プロフィール画像のURL
  - `role`: ユーザーの権限
  - `membership`: メンバーシップの種類

### `VerificationToken`

**Properties**
  - `identifier`: 検証対象の識別子（メールアドレスなど）
  - `token`: 検証トークン
  - `expires`: トークンの有効期限


## UserMcpServer
```mermaid
erDiagram
"User" {
  String id PK
  String name "nullable"
  String email UK "nullable"
  DateTime emailVerified "nullable"
  String image "nullable"
  Role role
  MembershipType membership
}
"McpServerConfig" {
  String id PK
  String name "nullable"
  String envVars
  String mcpServerId FK
  String userId FK
  DateTime createdAt
  DateTime updatedAt
}
"ToolGroupTool" {
  String toolGroupId FK
  String toolId FK
  String mcpServerConfigId FK
  DateTime createdAt
  DateTime updatedAt
}
"ToolGroup" {
  String id PK
  String name
  String description
  Boolean isEnabled
  String order
  String userId FK
  String mcpServerInstanceId "nullable"
  DateTime createdAt
  DateTime updatedAt
}
"McpServerInstance" {
  String id PK
  String name
  String description
  String userId FK
  String order
  DateTime createdAt
  DateTime updatedAt
}
"_McpServerConfigToTool" {
  String A FK
  String B FK
}
"_McpServerInstanceToToolGroup" {
  String A FK
  String B FK
}
"McpServerConfig" }o--|| "User" : user
"ToolGroupTool" }o--|| "ToolGroup" : toolGroup
"ToolGroupTool" }o--|| "McpServerConfig" : mcpServerConfig
"ToolGroup" }o--|| "User" : user
"McpServerInstance" }o--|| "User" : user
"_McpServerConfigToTool" }o--|| "McpServerConfig" : McpServerConfig
"_McpServerInstanceToToolGroup" }o--|| "McpServerInstance" : McpServerInstance
"_McpServerInstanceToToolGroup" }o--|| "ToolGroup" : ToolGroup
```

### `User`

**Properties**
  - `id`: 
  - `name`: ユーザー名
  - `email`: メールアドレス
  - `emailVerified`: メールアドレスの検証日時
  - `image`: プロフィール画像のURL
  - `role`: ユーザーの権限
  - `membership`: メンバーシップの種類

### `McpServerConfig`
ユーザーが利用できるMCPサーバーの設定

**Properties**
  - `id`: 
  - `name`: カスタムMCPサーバー名 (ユーザーが設定した名前)
  - `envVars`: MCPサーバーの envVars を文字配列を key にしたオブジェクトを Object.stringify + 暗号化したもの
  - `mcpServerId`: MCPサーバーID
  - `userId`: ユーザーID
  - `createdAt`: 
  - `updatedAt`: 

### `ToolGroupTool`
ToolGroup, Tool, McpServerConfig の関連を表す中間テーブル

**Properties**
  - `toolGroupId`: ToolGroupへの参照
  - `toolId`: Toolへの参照
  - `mcpServerConfigId`: このToolがどのUserMcpServerに属しているか
  - `createdAt`: 
  - `updatedAt`: 

### `ToolGroup`
どのツール群を利用するかを設定する

**Properties**
  - `id`: 
  - `name`: ツールグループ名
  - `description`: ツールグループの説明
  - `isEnabled`: ツールグループが有効かどうか
  - `order`: ツールの表示順序を保持するためのID配列
  - `userId`: ユーザーID
  - `mcpServerInstanceId`: McpServerInstance に直接紐づくものは、id を管理する
  - `createdAt`: 
  - `updatedAt`: 

### `McpServerInstance`
MCPサーバーとして利用するインスタンス

**Properties**
  - `id`: 
  - `name`: サーバー名
  - `description`: サーバーの説明
  - `userId`: ユーザーID
  - `order`: ツールグループとツールの表示順序を保持するためのID配列
  - `createdAt`: 
  - `updatedAt`: 

### `_McpServerConfigToTool`
Pair relationship table between [McpServerConfig](#McpServerConfig) and [Tool](#Tool)

**Properties**
  - `A`: 
  - `B`: 

### `_McpServerInstanceToToolGroup`
Pair relationship table between [McpServerInstance](#McpServerInstance) and [ToolGroup](#ToolGroup)

**Properties**
  - `A`: 
  - `B`: 
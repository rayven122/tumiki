{
  "name": "tumiki",
  "type": "module",
  "private": true,
  "version": "0.1.0",
  "engines": {
    "node": ">=22.14.0",
    "pnpm": ">=9.6.0"
  },
  "packageManager": "pnpm@10.11.0",
  "pnpm": {
    "overrides": {
      "tar": ">=7.5.7",
      "undici": ">=6.23.0",
      "fast-xml-parser": ">=5.4.1"
    }
  },
  "scripts": {
    "build": "turbo run build",
    "clean": "git clean -xdf node_modules",
    "clean:workspaces": "turbo run clean",
    "dev": "turbo watch dev --filter=@tumiki/mcp-proxy --filter=@tumiki/manager --continue",
    "start": "turbo run start --filter=@tumiki/mcp-proxy --filter=@tumiki/manager --continue",
    "format": "turbo run format --continue -- --cache --cache-location .cache/.prettiercache",
    "format:fix": "turbo run format --continue -- --write --cache --cache-location .cache/.prettiercache",
    "typecheck": "turbo run typecheck",
    "lint": "turbo run lint --continue -- --cache --cache-location .cache/.eslintcache",
    "lint:fix": "turbo run lint --continue -- --fix --cache --cache-location .cache/.eslintcache",
    "lint:ws": "pnpm dlx sherif@latest -i ai",
    "postinstall": "pnpm lint:ws && (command -v bash >/dev/null 2>&1 && bash docker/keycloak/install-themes.sh || echo 'Skipping theme install (bash not available)')",
    "test": "vitest run",
    "test:watch": "vitest",
    "test:coverage": "vitest run --coverage",
    "test:ui": "vitest --ui",
    "check": "concurrently --kill-others-on-fail --names \"lint,format,typecheck\" \"pnpm run lint\" \"pnpm run format\" \"pnpm run typecheck\"",
    "docker:up": "docker compose -f docker/local/compose.yaml up -d",
    "docker:stop": "docker compose -f docker/local/compose.yaml stop",
    "docker:down": "docker compose -f docker/local/compose.yaml down",
    "docker:ps": "docker compose -f docker/local/compose.yaml ps",
    "docker:logs": "docker compose -f docker/local/compose.yaml logs",
    "keycloak:init": "bash scripts/keycloak.sh init",
    "keycloak:plan": "bash scripts/keycloak.sh plan",
    "keycloak:apply": "bash scripts/keycloak.sh apply",
    "keycloak:destroy": "bash scripts/keycloak.sh destroy",
    "keycloak:wait": "echo 'Waiting for Keycloak to be ready...' && until docker compose -f docker/local/compose.yaml exec keycloak bash -c 'exec 3<>/dev/tcp/localhost/9000 && echo -e \"GET /health/ready HTTP/1.1\\r\\nHost: localhost\\r\\nConnection: close\\r\\n\\r\\n\" >&3 && grep -q \"200 OK\" <&3' 2>/dev/null; do sleep 2; echo 'Still waiting...'; done && echo 'Keycloak is ready!'",
    "keycloak:dev-init": "echo 'Configuring master realm for development...' && docker compose -f docker/local/compose.yaml exec keycloak /opt/keycloak/bin/kcadm.sh config credentials --server http://localhost:8080 --realm master --user \"${KEYCLOAK_ADMIN_USERNAME:-admin}\" --password \"${KEYCLOAK_ADMIN_PASSWORD:-admin123}\" && docker compose -f docker/local/compose.yaml exec keycloak /opt/keycloak/bin/kcadm.sh update realms/master -s sslRequired=none && echo 'Master realm SSL requirement set to none'",
    "setup:dev": "pnpm docker:up && pnpm keycloak:wait && pnpm keycloak:dev-init && pnpm keycloak:init && pnpm keycloak:apply",
    "keycloak:prod:plan": "bash scripts/keycloak.sh plan -var-file=terraform.tfvars.production",
    "keycloak:prod:apply": "bash scripts/keycloak.sh apply -var-file=terraform.tfvars.production",
    "keycloak:prod:destroy": "bash scripts/keycloak.sh destroy -var-file=terraform.tfvars.production",
    "keycloak:prod:setup-db": "bash docker/prod/deploy.sh setup-db",
    "keycloak:prod:setup": "bash docker/prod/deploy.sh setup",
    "keycloak:prod:deploy": "bash docker/prod/deploy.sh deploy",
    "keycloak:prod:status": "bash docker/prod/deploy.sh status",
    "keycloak:prod:logs": "bash docker/prod/deploy.sh logs",
    "keycloak:prod:restart": "bash docker/prod/deploy.sh restart",
    "keycloak:prod:shell": "bash docker/prod/deploy.sh shell",
    "db:generate": "pnpm --filter @tumiki/db db:generate",
    "verify:stripe": "tsx scripts/verify-stripe-env.ts",
    "stripe:listen": "stripe listen --forward-to localhost:3000/api/webhooks/stripe",
    "inspector": "mcp-inspector",
    "inspector:mcp-proxy": "mcp-inspector --transport http http://localhost:8080/mcp"
  },
  "devDependencies": {
    "@modelcontextprotocol/inspector": "^0.21.1",
    "@testing-library/jest-dom": "^6.9.1",
    "@typescript/native-preview": "7.0.0-dev.20250814.1",
    "@vitest/coverage-v8": "catalog:",
    "concurrently": "^9.2.1",
    "turbo": "^2.8.3",
    "typescript": "catalog:",
    "vitest": "catalog:"
  }
}
